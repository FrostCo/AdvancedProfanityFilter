/*! For license information please see bookmarkletFilter.js.LICENSE.txt */
(()=>{var e={50:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,a=(s=i(357))&&s.__esModule?s:{default:s};function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class r{static byHostname(e,t){const i=r.findDomainKey(e,t)||e,s=r.byKey(i,t);return s.hostname=e,s}static byKey(e,t){return new r(e,t[e])}static findDomainKey(e,t){return Object.keys(t).sort(((e,t)=>t.length-e.length)).find((t=>new RegExp(`(^|.)${t}$`).test(e)))}static getCurrentTab(){return new Promise(((e,t)=>{chrome.tabs.query({active:!0,currentWindow:!0},(t=>{e(t[0])}))}))}static sortedKeys(e){return Object.keys(e).sort(((e,t)=>{const i=r.sortingKey(e),s=r.sortingKey(t);return i==s?e<t?-1:e>t?1:0:i<s?-1:i>s?1:0}))}static sortingKey(e){const t=e.split(".");switch(t.length){case 1:case 2:return t[0];case 3:return t[1];case 4:return t[1].match(/^\d+$/)?e:t[3].length?t[1]:t[2];default:return t[2]}}constructor(e,t){o(this,"advanced",void 0),o(this,"audioWordlistId",void 0),o(this,"cfg",void 0),o(this,"cfgKey",void 0),o(this,"deep",void 0),o(this,"disabled",void 0),o(this,"enabled",void 0),o(this,"hostname",void 0),o(this,"tab",void 0),o(this,"wordlistId",void 0),this.cfgKey=e,this.cfg={},t?this.cfg=t:Object.assign(this.cfg,r._domainCfgDefaults),this.updateFromCfg()}getModeIndex(){return this.advanced?a.default.DOMAIN_MODES.ADVANCED:this.deep?a.default.DOMAIN_MODES.DEEP:a.default.DOMAIN_MODES.NORMAL}async save(e){if(e.domains)return this.updateCfg(),"{}"===JSON.stringify(this.cfg)?delete e.domains[this.cfgKey]:e.domains[this.cfgKey]=this.cfg,await e.save("domains")}updateCfg(){this.cfg.adv=!0===this.advanced||void 0,this.cfg.deep=!0===this.deep||void 0,this.cfg.disabled=!0===this.disabled||void 0,this.cfg.enabled=!0===this.enabled||void 0,this.cfg.wordlist=this.wordlistId>=0?this.wordlistId:void 0,this.cfg.audioList=this.audioWordlistId>=0?this.audioWordlistId:void 0}updateFromCfg(){this.advanced=this.cfg.adv,this.deep=this.cfg.deep,this.disabled=this.cfg.disabled,this.enabled=this.cfg.enabled,this.wordlistId=this.cfg.wordlist,this.audioWordlistId=this.cfg.audioList}updateFromModeIndex(e){switch(e){case a.default.DOMAIN_MODES.NORMAL:this.advanced=!1,this.deep=!1;break;case a.default.DOMAIN_MODES.ADVANCED:this.advanced=!0,this.deep=!1;break;case a.default.DOMAIN_MODES.DEEP:this.advanced=!1,this.deep=!0}}}t.default=r,o(r,"_domainCfgDefaults",{adv:void 0,audioList:void 0,deep:void 0,disabled:void 0,enabled:void 0,wordlist:void 0})},513:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,a=(s=i(357))&&s.__esModule?s:{default:s};function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class r{constructor(e={}){o(this,"censorCharacter",void 0),o(this,"censorFixedLength",void 0),o(this,"defaultSubstitution",void 0),o(this,"defaultWordMatchMethod",void 0),o(this,"defaultWordRepeat",void 0),o(this,"defaultWordSeparators",void 0),o(this,"filterMethod",void 0),o(this,"filterWordList",void 0),o(this,"iWordWhitelist",void 0),o(this,"loggingLevel",void 0),o(this,"preserveCase",void 0),o(this,"preserveFirst",void 0),o(this,"preserveLast",void 0),o(this,"showCounter",void 0),o(this,"showSummary",void 0),o(this,"substitutionMark",void 0),o(this,"wordlistId",void 0),o(this,"wordlists",void 0),o(this,"wordlistsEnabled",void 0),o(this,"words",void 0),o(this,"wordWhitelist",void 0),Object.assign(this,r._defaults,e)}addWord(e,t=this.defaultWordOptions()){return e=e.trim(),(t=Object.assign({},this.defaultWordOptions(),t)).matchMethod!==a.default.MATCH_METHODS.REGEX&&(e=e.toLowerCase()),!Object.keys(this.words).includes(e)&&(t.sub=t.case==a.default.TRUE?t.sub.trim():t.sub.trim().toLowerCase(),this.words[e]=t,!0)}defaultWordOptions(){return{lists:[],matchMethod:this.defaultWordMatchMethod,repeat:this.defaultWordRepeat,separators:this.defaultWordSeparators,sub:""}}removeWord(e){const t=(e=e.trim()).toLowerCase();return Object.keys(this.words).includes(t)?(delete this.words[t],!0):!!this.words[e]&&(delete this.words[e],!0)}repeatForWord(e){return this.words[e].repeat===a.default.TRUE||this.words[e].repeat===a.default.FALSE?this.words[e].repeat:this.defaultWordRepeat}sanitizeWords(){const e={};Object.keys(this.words).sort().forEach((t=>{e[t.trim().toLowerCase()]=this.words[t]})),this.words=e}}t.default=r,o(r,"_allWordlists",["All words"]),o(r,"_defaults",{censorCharacter:"*",censorFixedLength:0,defaultSubstitution:"censored",defaultWordMatchMethod:a.default.MATCH_METHODS.EXACT,defaultWordRepeat:a.default.FALSE,defaultWordSeparators:a.default.FALSE,filterMethod:a.default.FILTER_METHODS.SUBSTITUTE,filterWordList:!0,iWordWhitelist:[],loggingLevel:a.default.LOGGING_LEVELS.WARN,preserveCase:!0,preserveFirst:!0,preserveLast:!1,showCounter:!0,showSummary:!0,substitutionMark:!1,wordlistId:0,wordlists:["Wordlist 1","Wordlist 2","Wordlist 3","Wordlist 4","Wordlist 5","Wordlist 6"],wordlistsEnabled:!0,wordWhitelist:[]}),o(r,"_defaultWords",{ass:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"butt"},asses:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.FALSE,separators:a.default.FALSE,sub:"butts"},asshole:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"jerk"},badass:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.TRUE,sub:"cool"},bastard:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"idiot"},bitch:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"bench"},cocksucker:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.TRUE,sub:"suckup"},cunt:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"expletive"},dammit:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.FALSE,separators:a.default.TRUE,sub:"dangit"},damn:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.FALSE,separators:a.default.FALSE,sub:"dang"},dumbass:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"idiot"},fag:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"gay"},faggot:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"gay"},fags:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"gays"},fuck:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.TRUE,sub:"freak"},goddammit:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.TRUE,sub:"dangit"},hell:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.FALSE,separators:a.default.FALSE,sub:"heck"},jackass:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.TRUE,sub:"jerk"},nigga:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"bruh"},nigger:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"man"},niggers:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"people"},piss:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"pee"},pissed:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"ticked"},pussies:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"softies"},pussy:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"softie"},shit:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"crap"},slut:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"tramp"},tits:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"chest"},twat:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"dumbo"},twats:{lists:[],matchMethod:a.default.MATCH_METHODS.EXACT,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"dumbos"},whore:{lists:[],matchMethod:a.default.MATCH_METHODS.PARTIAL,repeat:a.default.TRUE,separators:a.default.FALSE,sub:"tramp"}})},357:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(582);function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class o{static filterMethodName(e){return this.nameById(this.FILTER_METHODS,e)}static loggingLevelName(e){return this.nameByValue(this.LOGGING_LEVELS,e)}static matchMethodName(e){return this.nameById(this.MATCH_METHODS,e)}static nameById(e,t){return(0,s.upperCaseFirst)(Object.entries(e).filter((e=>e[1]===t))[0][0])}static nameByValue(e,t){return Object.keys(e).find((i=>e[i]==t))}static orderedArray(e){const t=[];return Object.values(e).sort().forEach((i=>{t.push(o.nameById(e,i))})),t}}t.default=o,a(o,"ALL_WORDS_WORDLIST_ID",0),a(o,"BUILD_TARGET_BOOKMARKLET","bookmarklet"),a(o,"BUILD_TARGET_CHROME","chrome"),a(o,"BUILD_TARGET_FIREFOX","firefox"),a(o,"BUILD_TARGET_IOS","ios"),a(o,"BUILD_TARGET_SAFARI","safari"),a(o,"DOMAIN_MODES",{NORMAL:0,ADVANCED:1,DEEP:2}),a(o,"FALSE",0),a(o,"FILTER_METHODS",{CENSOR:0,SUBSTITUTE:1,REMOVE:2,OFF:3}),a(o,"LOGGING_LEVELS",{DEBUG:0,INFO:1,WARN:2,ERROR:3}),a(o,"MATCH_METHODS",{EXACT:0,PARTIAL:1,WHOLE:2,REGEX:3}),a(o,"MUTE_METHODS",{TAB:0,VIDEO_VOLUME:1,VIDEO_MUTE:2,NONE:9}),a(o,"SHOW_SUBTITLES",{ALL:0,FILTERED:1,UNFILTERED:2,NONE:3}),a(o,"STATS_TYPE_AUDIO","audio"),a(o,"STATS_TYPE_TEXT","text"),a(o,"TRUE",1)},394:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=r(i(357)),a=r(i(812)),o=r(i(709));function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}t.default=class{constructor(){n(this,"cfg",void 0),n(this,"counter",void 0),n(this,"iWhitelist",void 0),n(this,"whitelist",void 0),n(this,"wordlistId",void 0),n(this,"wordlists",void 0),this.counter=0,this.iWhitelist=[],this.whitelist=[],this.wordlists={}}buildWordlist(e,t=!1){return!1===e&&(e=this.wordlistId),!t&&this.wordlists[e]||(this.wordlists[e]=new o.default(this.cfg,e)),e}checkWhitelist(e,t,i,o){const r=this.whitelist.length,n=this.iWhitelist.length;if(r||n){if(r&&this.whitelist.includes(e))return!0;if(n&&this.iWhitelist.includes(e.toLowerCase()))return!0;if(o.matchMethod===s.default.MATCH_METHODS.PARTIAL){const o={matchMethod:s.default.MATCH_METHODS.WHOLE,repeat:s.default.FALSE,separators:s.default.FALSE,sub:""},l=new a.default(e,o,this.cfg).regExp;let d;for(;null!==(d=l.exec(t));){const t=4==d.length?d[2]:d[0],s=4==d.length?d.index+d[1].length:d.index;if(s<=i&&s+t.length>=i+e.length){if(r&&this.whitelist.includes(t))return!0;if(n&&this.iWhitelist.includes(t.toLowerCase()))return!0}}}}return!1}foundMatch(e,t){this.counter++}init(e=!1){this.iWhitelist=this.cfg.iWordWhitelist,this.whitelist=this.cfg.wordWhitelist,void 0===this.wordlistId&&(this.wordlistId=null==this.cfg.wordlistId?s.default.ALL_WORDS_WORDLIST_ID:this.cfg.wordlistId),this.buildWordlist(e)}matchData(e,t,i,a){const o=e.find(t),r=a.pop(),n=a.pop(),l=a,d=l.length>0&&o.matchMethod!==s.default.MATCH_METHODS.REGEX;return d&&(i=l[1]),{word:o,string:r,match:i,matchStartIndex:n,captureGroups:l,internalCaptureGroups:d}}rebuildWordlists(){Object.keys(this.wordlists).forEach((e=>{this.buildWordlist(parseInt(e),!0)}))}replaceText(e,t=!1,i=s.default.STATS_TYPE_TEXT){t=this.buildWordlist(t);const o=this.wordlists[t];switch(this.cfg.filterMethod){case s.default.FILTER_METHODS.OFF:case s.default.FILTER_METHODS.CENSOR:o.regExps.forEach(((t,s)=>{e=e.replace(t,((e,...t)=>{const{word:a,string:r,match:n,matchStartIndex:l,captureGroups:d,internalCaptureGroups:u}=this.matchData(o,s,e,t);if(this.checkWhitelist(n,r,l,a))return n;i&&this.foundMatch(a,i);let c="";const h=this.cfg.censorFixedLength>0?this.cfg.censorFixedLength:n.length;return c=this.cfg.preserveFirst&&this.cfg.preserveLast?n[0]+this.cfg.censorCharacter.repeat(h-2)+n.slice(-1):this.cfg.preserveFirst?n[0]+this.cfg.censorCharacter.repeat(h-1):this.cfg.preserveLast?this.cfg.censorCharacter.repeat(h-1)+n.slice(-1):this.cfg.censorCharacter.repeat(h),u&&(c=d[0]+c+d[2]),c}))}));break;case s.default.FILTER_METHODS.SUBSTITUTE:o.regExps.forEach(((t,r)=>{e=e.replace(t,((e,...t)=>{const{word:n,string:l,match:d,matchStartIndex:u,captureGroups:c,internalCaptureGroups:h}=this.matchData(o,r,e,t);if(this.checkWhitelist(d,l,u,n))return d;i&&this.foundMatch(n,i);let p=n.sub||this.cfg.defaultSubstitution;return n.matchMethod==s.default.MATCH_METHODS.REGEX&&c.length&&n.sub.includes("\\1")&&(c.forEach(((e,t)=>{p=p.replace(`\\${t+1}`,this.cfg.preserveCase?e:e.toLowerCase())})),p!==n.sub)?(this.cfg.substitutionMark&&(p="["+p+"]"),p):(n.case==s.default.FALSE&&this.cfg.preserveCase&&(a.default.allUpperCase(d)?p=p.toUpperCase():a.default.eachWordCapitalized(d)?p=a.default.capitalizeEachWord(p):a.default.firstCapitalized(d)&&(p=a.default.capitalizeFirst(p))),this.cfg.substitutionMark&&(p="["+p+"]"),h&&(p=c[0]+p+c[2]),p)}))}));break;case s.default.FILTER_METHODS.REMOVE:o.regExps.forEach(((t,s)=>{e=e.replace(t,((e,...t)=>{const{word:r,string:n,match:l,matchStartIndex:d,captureGroups:u,internalCaptureGroups:c}=this.matchData(o,s,e,t);return this.checkWhitelist(l.trim(),n,d,r)?l:(i&&this.foundMatch(r,i),c?a.default.whitespaceRegExp.test(u[0])&&a.default.whitespaceRegExp.test(u[2])?u[0]:a.default.nonWordRegExp.test(u[0])||a.default.nonWordRegExp.test(u[2])?(u[0]+u[2]).trim():"":a.default.whitespaceRegExp.test(l[0])&&a.default.whitespaceRegExp.test(l[l.length-1])?l[0]:"")}))}))}return e}replaceTextResult(e,t=!1,i=s.default.STATS_TYPE_TEXT){const a={original:e,filtered:this.replaceText(e,t,i),modified:!1};return a.modified=a.filtered!=e,a}}},582:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.booleanToNumber=function(e){return e?a.default.TRUE:a.default.FALSE},t.cloneWithJSON=function(e){return JSON.parse(JSON.stringify(e))},t.dynamicList=function(e,t,i=!1,s){n(t);(void 0!==s?[s].concat(e):e).forEach((e=>{const a=document.createElement("option");a.value=s&&e===s?"":e,a.textContent=i?l(e):e,t.appendChild(a)}))},t.exportToFile=function(e,t="data.txt"){const i="data:application/json;charset=utf-8,"+encodeURIComponent(e),s=document.createElement("a");s.setAttribute("href",i),s.setAttribute("download",t),s.click(),s.remove()},t.formatNumber=function(e){const t=e.toString().length;if(t<=3)return e.toString();if(t<=6){const t=(e/1e3).toPrecision(),i=t.indexOf(".");return(i>=-1&&i<=1?t.slice(0,3):t.slice(0,i))+"k"}if(t<=9){const t=(e/1e6).toPrecision(),i=t.indexOf(".");return(i>=-1&&i<=1?t.slice(0,3):t.slice(0,i))+"M"}return"1G+"},t.getElement=function(e,t=document){let i;const s=e.split(">>>");if(1==s.length)return t.querySelector(e);for(;s.length;){if(!t)return null;if(i=t.querySelector(s.shift().trim()),!i)return null;if(0==s.length)return i;t=i.shadowRoot}},t.getElements=function(e,t=document){let i;const s=e.split(">>>");if(1==s.length)return t.querySelectorAll(e);for(;s.length;){if(!t)return null;{const e=s.shift().trim();if(0==s.length)return t.querySelectorAll(e);if(i=t.querySelector(e),!i)return null;t=i.shadowRoot}}},t.getGlobalVariable=function(e,t="APFData"){const i=document.createElement("script");i.id=t,i.textContent=`document.getElementById("${t}").textContent = JSON.stringify(${e})`,document.documentElement.appendChild(i);const s=document.querySelector(`script#${t}`).textContent;return i.remove(),JSON.parse(s)},t.getGlobalVariableFromBackground=function(e){return new Promise(((t,i)=>{chrome.runtime.sendMessage({globalVariable:e},(e=>{t(e)}))}))},t.getParent=function e(t,i=1){return t?i>0?e(t.parentElement,i-1):t:null},t.getVersion=function(e){const t=e.split(".");return{major:parseInt(t[0]),minor:parseInt(t[1]),patch:parseInt(t[2])}},t.hmsToSeconds=function(e,t=3){const[i="0",s="0",a="0"]=(e||"0:0:0").split(":"),o=parseInt(i,10)||0,r=parseInt(s,10)||0,n=parseFloat(a)||0;return parseFloat((3600*o+60*r+n).toFixed(t))},t.injectScript=function(e,t,i=""){const s=document.getElementsByTagName(t)[0],a=document.createElement("script");a.setAttribute("type","text/javascript"),i&&(a.id=i);a.setAttribute("src",e),s.appendChild(a)},t.isVersionOlder=function(e,t){if(e.major<t.major)return!0;if(e.major==t.major&&e.minor<t.minor)return!0;if(e.major==t.major&&e.minor==t.minor&&e.patch<t.patch)return!0;return!1},t.makeBackgroundRequest=function(e,t){return new Promise(((i,s)=>{chrome.runtime.sendMessage({fetch:e,fetchMethod:t.toUpperCase()},(e=>{i(e)}))}))},t.makeFetchRequest=o,t.makeRequest=async function(e,t){return fetch?await o(e,t):await r(e,t)},t.makeXMLHttpRequest=r,t.numberToBoolean=function(e){return e>a.default.FALSE},t.numberWithCommas=function(e){if("object"==typeof Intl&&"function"==typeof Intl.NumberFormat)return"string"==typeof e&&(e=parseInt(e).toString()),e.toLocaleString();{const t=(e=e.toString()).indexOf(".");let i=-1===t?e:e.slice(0,t);for(let e=i.length-3;e>0;e-=3)i=i.slice(0,e)+","+i.slice(e);return-1!==t&&(i+=e.slice(t)),i}},t.prettyPrintArray=function(e){return`[${e.toString().replace(/,/g,", ")}]`},t.readFile=function(e){return new Promise(((t,i)=>{const s=new FileReader;s.onload=()=>{t(s.result)},s.readAsText(e)}))},t.removeChildren=n,t.removeFromArray=function(e,t){return e.filter((e=>e!==t))},t.secondsToHMS=function(e){return new Date(1e3*e).toISOString().slice(11,23)},t.stringArray=function(e){"string"==typeof e&&(e=[e]);return e},t.upperCaseFirst=l;var s,a=(s=i(357))&&s.__esModule?s:{default:s};async function o(e,t="GET"){const i=await fetch(e,{method:t});return await i.text()}function r(e,t){return new Promise(((i,s)=>{const a=new XMLHttpRequest;a.open(t,e),a.onload=function(){this.status>=200&&this.status<300?i(this.response):s({status:this.status,statusText:this.statusText})},a.onerror=function(){s({status:this.status,statusText:this.statusText})},a.send()}))}function n(e){if(e.hasChildNodes)for(;e.firstChild;)e.firstChild.remove()}function l(e,t=!0){let i=e.charAt(0).toUpperCase();return i+=t?e.toLowerCase().slice(1):e.slice(1),i}},167:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,a=(s=i(357))&&s.__esModule?s:{default:s};function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class r{static debug(e,...t){this.log(this.debugName,e,t)}static debugTime(e,t=[]){this.logTime(this.debugName,e,t)}static error(e,...t){this.log(this.errorName,e,t)}static errorTime(e,t=[]){this.logTime(this.errorName,e,t)}static info(e,...t){this.log(this.infoName,e,t)}static infoTime(e,t=[]){this.logTime(this.infoName,e,t)}static log(e,t,i=[]){t=`[${r.app}] ${t}`,i.length?console[e](t,i):console[e](t)}static logTime(e,t,i=[]){const s=(new Date).toLocaleString();t=`[${r.app}] ${t}`,i.length?console[e](t,s,i):console[e](t,s)}static warn(e,...t){this.log(this.warnName,e,t)}static warnTime(e,t=[]){this.logTime(this.warnName,e,t)}constructor(e){o(this,"level",void 0),o(this,"prefix",void 0),this.level=r.defaultLevel,this.prefix="",e&&(this.prefix=`[${e}] `)}debug(e,...t){r.debugLevel>=this.level&&r.log(r.debugName,`${this.prefix}${e}`,t)}debugTime(e,...t){r.debugLevel>=this.level&&r.logTime(r.debugName,`${this.prefix}${e}`,t)}error(e,...t){r.errorLevel>=this.level&&r.log(r.errorName,`${this.prefix}${e}`,t)}errorTime(e,...t){r.errorLevel>=this.level&&r.logTime(r.errorName,`${this.prefix}${e}`,t)}info(e,...t){r.infoLevel>=this.level&&r.log(r.infoName,`${this.prefix}${e}`,t)}infoTime(e,...t){r.infoLevel>=this.level&&r.logTime(r.infoName,`${this.prefix}${e}`,t)}setLevel(e){this.level=e}warn(e,...t){r.warnLevel>=this.level&&r.log(r.warnName,`${this.prefix}${e}`,t)}warnTime(e,...t){r.warnLevel>=this.level&&r.logTime(r.warnName,`${this.prefix}${e}`,t)}}t.default=r,o(r,"app","APF"),o(r,"debugLevel",a.default.LOGGING_LEVELS.DEBUG),o(r,"debugName",a.default.loggingLevelName(r.debugLevel).toLowerCase()),o(r,"defaultLevel",a.default.LOGGING_LEVELS.WARN),o(r,"errorLevel",a.default.LOGGING_LEVELS.ERROR),o(r,"errorName",a.default.loggingLevelName(r.errorLevel).toLowerCase()),o(r,"infoLevel",a.default.LOGGING_LEVELS.INFO),o(r,"infoName",a.default.loggingLevelName(r.infoLevel).toLowerCase()),o(r,"warnLevel",a.default.LOGGING_LEVELS.WARN),o(r,"warnName",a.default.loggingLevelName(r.warnLevel).toLowerCase())},812:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,a=(s=i(357))&&s.__esModule?s:{default:s};function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class r{static allLowerCase(e){return e.toLowerCase()===e}static allUpperCase(e){return e.toUpperCase()===e}static capitalizeEachWord(e){return e.split(/[-_ ]+/i).forEach((t=>{e=e.replace(t,this.capitalizeFirst(t))})),e}static capitalizeFirst(e){return e.charAt(0).toUpperCase()+e.slice(1)}static containsDoubleByte(e){return!!e.length&&(e.charCodeAt(0)>127||r._unicodeRegExp.test(e))}static eachWordCapitalized(e){return e.split(/[-_ ]+/i).every((e=>this.firstCapitalized(e)))}static escapeRegExp(e){return e.replace(r._escapeRegExp,"\\$&")}static firstCapitalized(e){const t=e.charAt(0);return t===t.toUpperCase()&&t!==t.toLowerCase()}constructor(e,t,i){o(this,"_filterMethod",void 0),o(this,"case",void 0),o(this,"escaped",void 0),o(this,"lists",void 0),o(this,"matchMethod",void 0),o(this,"matchRepeated",void 0),o(this,"matchSeparators",void 0),o(this,"regExp",void 0),o(this,"sub",void 0),o(this,"unicode",void 0),o(this,"value",void 0),this.value=e,this.case=t.case>a.default.FALSE?a.default.TRUE:a.default.FALSE,this.lists=void 0===t.lists?[]:t.lists,this.matchMethod=void 0===t.matchMethod?i.defaultWordMatchMethod:t.matchMethod,this.matchRepeated=void 0===t.repeat?i.defaultWordRepeat:t.repeat,this.matchSeparators=void 0===t.separators?i.defaultWordSeparators:t.separators,this.sub=void 0===t.sub?i.defaultSubstitution:t.sub,this._filterMethod=void 0===t._filterMethod?i.filterMethod:t._filterMethod,this.unicode=r.containsDoubleByte(e),this.escaped=this.matchMethod===a.default.MATCH_METHODS.REGEX?this.value:r.escapeRegExp(this.value),this.regExp=this.buildRegExp()}buildRegExp(){try{switch(this.matchMethod){case a.default.MATCH_METHODS.PARTIAL:return this._filterMethod===a.default.FILTER_METHODS.REMOVE?this.unicode?new RegExp("(^|"+r._unicodeWordBoundary+"?)([\\w-]*"+this.processedPhrase()+"[\\w-]*)("+r._unicodeWordBoundary+"?|$)",this.regexOptions()):this.hasEdgePunctuation()?new RegExp("(^|\\s)([\\w-]*"+this.processedPhrase()+"[\\w-]*)(\\s|$)",this.regexOptions()):new RegExp("\\s?\\b[\\w-]*"+this.processedPhrase()+"[\\w-]*\\b\\s?",this.regexOptions()):new RegExp(this.processedPhrase(),this.regexOptions());case a.default.MATCH_METHODS.WHOLE:return this.unicode?new RegExp("(^|"+r._unicodeWordBoundary+"*)([\\S]*"+this.processedPhrase()+"[\\S]*)("+r._unicodeWordBoundary+"*|$)",this.regexOptions()):this.hasEdgePunctuation()?new RegExp("(^|\\s)([\\S]*"+this.processedPhrase()+"[\\S]*)(\\s|$)",this.regexOptions()):new RegExp("\\b[\\w-]*"+this.processedPhrase()+"[\\w-]*\\b",this.regexOptions());case a.default.MATCH_METHODS.REGEX:return new RegExp(this.value,this.regexOptions());case a.default.MATCH_METHODS.EXACT:default:return this.unicode||"-"!=this.value[0]&&"-"!=this.value[this.value.length-1]||(this.unicode=!0),this._filterMethod===a.default.FILTER_METHODS.REMOVE?this.unicode?new RegExp("(^|"+r._unicodeWordBoundary+")("+this.processedPhrase()+")("+r._unicodeWordBoundary+"|$)",this.regexOptions()):this.hasEdgePunctuation()?new RegExp("(^|\\s)("+this.processedPhrase()+")(\\s|$)",this.regexOptions()):new RegExp("\\s?\\b"+this.processedPhrase()+"\\b\\s?",this.regexOptions()):this.unicode?new RegExp("(^|"+r._unicodeWordBoundary+"+)("+this.processedPhrase()+")("+r._unicodeWordBoundary+"+|$)",this.regexOptions()):this.hasEdgePunctuation()?new RegExp("(^|\\s)("+this.processedPhrase()+")(\\s|$)",this.regexOptions()):new RegExp("\\b"+this.processedPhrase()+"\\b",this.regexOptions())}}catch(e){throw new Error(`Failed to create RegExp for '${this.value}'. [${e.name}: ${e.message}]`)}}hasEdgePunctuation(){return r._edgePunctuationRegExp.test(this.value)}processedPhrase(){const e=this.escaped.includes("\\");let t="";const i=this.escaped.length-1;for(let s=0;s<this.escaped.length;s++)e&&"\\"===this.escaped[s]&&(t+=this.escaped[s],s++),t+=this.escaped[s],this.matchRepeated&&(t+="+"),this.matchSeparators&&s!=i&&(t+=r.separatorsRegExp);return t}regexOptions(){let e="gi";return this.unicode&&(e+="u"),e}}t.default=r,o(r,"_edgePunctuationRegExp",/(^[,.'"!?%$+]|[,.'"!?%$+]$)/),o(r,"_escapeRegExp",/[\/\\^$*+?.()|[\]{}]/g),o(r,"_unicodeRegExp",/[^\u0000-\u00ff]/),o(r,"_unicodeWordBoundary","[\\s.,'\"+!?|-]"),o(r,"nonWordRegExp",new RegExp("^\\s*[^\\w]+\\s*$","g")),o(r,"separatorsRegExp","[-_ ]*"),o(r,"whitespaceRegExp",/^\s+$/)},709:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=o(i(357)),a=o(i(812));function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const n=new(o(i(167)).default)("Wordlist");t.default=class{constructor(e,t){r(this,"all",void 0),r(this,"list",void 0),r(this,"regExps",void 0),this.all=[],this.list=[],this.regExps=[],n.setLevel(e.loggingLevel);Object.keys(e.words).sort(((e,t)=>t.length-e.length)).forEach((i=>{if(t===s.default.ALL_WORDS_WORDLIST_ID||!Array.isArray(e.words[i].lists)||e.words[i].lists.includes(t))try{const t=new a.default(i,e.words[i],e);this.list.push(i),this.all.push(t),this.regExps.push(t.regExp)}catch(e){n.warn(`Failed to add '${i}' to wordlist.`,e)}}))}find(e){return"string"==typeof e?this.all[this.list.indexOf(e)]:"number"==typeof e?this.all[e]:void 0}}},470:(e,t)=>{"use strict";function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;class s{constructor(){i(this,"xpathDocText",void 0),i(this,"xpathNodeText",void 0)}static isForbiddenNode(e){return!!e.isContentEditable||(!(!e.parentNode||!e.parentNode.isContentEditable&&!s.forbiddenTags.includes(e.parentNode.nodeName))||s.forbiddenTags.includes(e.nodeName))}}t.default=s,i(s,"disabledProtocols",new RegExp("(^chrome:|^about:|^[a-zA-Z]+-extension:)","i")),i(s,"forbiddenNodeRegExp",new RegExp("^s*(<[a-z].+?/?>|{.+?:.+?;.*}|https?://[^s]+$)")),i(s,"forbiddenTags",["SCRIPT","STYLE","INPUT","TEXTAREA","IFRAME","LINK"])},210:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(i(357)),a=i(502),o=i(582),r=l(i(167)),n=l(i(863));function l(e){return e&&e.__esModule?e:{default:e}}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const u=new r.default("WebAudio");class c{static getBuildTargetConfig(){switch(n.default.BUILD.target){case s.default.BUILD_TARGET_IOS:return a.iOSTargetConfig;case s.default.BUILD_TARGET_SAFARI:return a.safariTargetConfig;default:return a.defaultTargetConfig}}static removeUnsupportedSites(e){Object.keys(e).forEach((t=>{const i=e[t];Array.isArray(i)||(e[t]=[i]),e[t]=e[t].filter((e=>null==e.buildTarget||e.buildTarget==n.default.BUILD.target))})),Object.keys(e).forEach((t=>{0==e[t].length&&delete e[t]}))}static supportedSites(e=!0){const t=c.getBuildTargetConfig(),i=Object.assign({},a.supportedSites,t.sites);return t.disabledSites.forEach((e=>{delete i[e]})),e&&c.removeUnsupportedSites(i),i}static supportedAndCustomSites(e){const t=Object.assign({},c.supportedSites(!1),e);return c.removeUnsupportedSites(t),t}constructor(e){d(this,"cueRuleIds",void 0),d(this,"enabledRuleIds",void 0),d(this,"fetching",void 0),d(this,"fillerAudio",void 0),d(this,"fillerAudioPauseHandler",void 0),d(this,"fillerAudioPlayHandler",void 0),d(this,"filter",void 0),d(this,"lastFilteredNode",void 0),d(this,"lastFilteredText",void 0),d(this,"lastProcessedText",void 0),d(this,"muted",void 0),d(this,"rules",void 0),d(this,"sites",void 0),d(this,"siteKey",void 0),d(this,"supportedPage",void 0),d(this,"unmuteTimeout",void 0),d(this,"volume",void 0),d(this,"watcherRuleIds",void 0),d(this,"wordlistId",void 0),d(this,"youTube",void 0),d(this,"youTubeAutoSubsMax",void 0),d(this,"youTubeAutoSubsMin",void 0),d(this,"youTubeAutoSubsRule",void 0),d(this,"youTubeAutoSubsTimeout",void 0),d(this,"youTubeAutoSubsUnmuteDelay",void 0),this.filter=e,u.setLevel(this.filter.cfg.loggingLevel),this.cueRuleIds=[],this.enabledRuleIds=[],this.watcherRuleIds=[],this.filter.extension&&(this.fillerAudio=this.initFillerAudio(this.filter.cfg.fillerAudio)),this.lastFilteredNode=null,this.lastFilteredText="",this.lastProcessedText="",this.muted=!1,e.cfg.customAudioSites&&"object"==typeof e.cfg.customAudioSites||(e.cfg.customAudioSites={}),this.sites=c.supportedAndCustomSites(e.cfg.customAudioSites),this.volume=1,this.wordlistId=e.audioWordlistId,this.youTubeAutoSubsMax=1e3*e.cfg.youTubeAutoSubsMax,this.youTubeAutoSubsMin=e.cfg.youTubeAutoSubsMin,this.youTubeAutoSubsUnmuteDelay=0,this.siteKey=this.getSiteKey(),this.rules=this.sites[this.siteKey],this.rules&&(this.rules.forEach((e=>{this.initRule(e)})),this.enabledRuleIds.length>0&&(this.supportedPage=!0,this.initYouTube()),this.cueRuleIds.length&&setInterval(this.watchForVideo,250,this))}apfCaptionLine(e,t){const i=document.createElement("span");return i.classList.add("APF-subtitle-line"),i.style.background="black",i.style.color="white",i.style.fontSize="3vw",i.style.paddingLeft="4px",i.style.paddingRight="4px",i.style.height="18px",i.textContent=t,i}apfCaptionLines(e,t){const i=document.createElement("div");return i.classList.add("APF-subtitles"),i.style.bottom="50px",i.style.position="absolute",i.style.textAlign="center",i.style.width="100%",t.forEach((e=>{i.appendChild(e),i.appendChild(document.createElement("br"))})),i}apfTextTrack(e,t){if(t){if(t.textTracks.length){const i=Array.from(t.textTracks).find((t=>t.label==e.apfCuesLabel));if(i)return i}return t.addTextTrack("captions",e.apfCuesLabel,e.apfCuesLabel)}}clean(e,t=0){const i=this.rules[t];if("watcher"===i.mode)return;let s=!1;e.nodeName&&"#text"===e.nodeName&&e.parentElement&&(e=e.parentElement);const a=i.subtitleSelector&&e.querySelectorAll?e.querySelectorAll(i.subtitleSelector):[e];if(0===a.length)return;a.forEach((e=>{const t="#text"===e.nodeName?"textContent":"innerText";!0===i.convertBreaks&&"#text"!==e.nodeName&&!c.brTagRegExp.test(e[t])&&c.brTagRegExp.test(e.innerHTML)&&("pre"!==e.style.whiteSpace&&(e.style.whiteSpace="pre"),e.textContent=e.innerHTML.replace(c.brTagRegExp,"\n"));const a=this.replaceTextResult(e[t]);a.modified&&(s=!0,this.mute(i),i.filterSubtitles&&(i.preserveWhiteSpace&&"pre"!==e.style.whiteSpace&&(e.style.whiteSpace="pre"),i.ignoreMutations&&this.filter.stopObserving(),e[t]=a.filtered,i.ignoreMutations&&this.filter.startObserving()),this.lastFilteredNode=e,this.lastFilteredText=e[t]),s||this.lastFilteredNode!=e||this.lastFilteredText!=e[t]||(s=!0)})),s||this.lastFilteredNode&&document.body.contains(this.lastFilteredNode)&&this.lastFilteredNode.textContent===this.lastFilteredText&&(s=!0);this.subtitlesShouldBeShown(i,s)?this.showSubtitles(i,a):this.hideSubtitles(i,a)}cleanYouTubeAutoSubs(e){null!=this.youTubeAutoSubsTimeout&&(clearTimeout(this.youTubeAutoSubsTimeout),this.youTubeAutoSubsTimeout=null);const t=this.replaceTextResult(e.textContent);if(t.modified)this.youTubeAutoSubsRule.filterSubtitles&&(e.textContent=t.filtered),this.mute(this.youTubeAutoSubsRule),this.youTubeAutoSubsUnmuteDelay=null,this.filter.updateCounterBadge(),this.youTubeAutoSubsMax&&(this.youTubeAutoSubsTimeout=window.setTimeout(this.youTubeAutoSubsMuteTimeout,this.youTubeAutoSubsMax,this));else if(this.muted)if(this.youTubeAutoSubsMin>0){const e=document.getElementsByTagName(c.defaultVideoSelector)[0].currentTime;null==this.youTubeAutoSubsUnmuteDelay?this.youTubeAutoSubsUnmuteDelay=e:(e<this.youTubeAutoSubsUnmuteDelay&&(this.youTubeAutoSubsUnmuteDelay=0),e>this.youTubeAutoSubsUnmuteDelay+this.youTubeAutoSubsMin&&this.unmute(this.youTubeAutoSubsRule))}else this.unmute(this.youTubeAutoSubsRule);if(this.filter.cfg.showSubtitles!==s.default.SHOW_SUBTITLES.ALL){const e=document.querySelector("div.ytp-caption-window-rollup span.captions-text");"block"==e.style.display&&(e.style.display="none")}}clearUnmuteTimeout(e){e.unmuteDelay&&null!=this.unmuteTimeout&&(clearTimeout(this.unmuteTimeout),this.unmuteTimeout=null)}cuesIncludingText(e,t,i="text"){return e.filter((e=>t.includes(e[i])))}cuesInTimeRange(e,t,i,s=0){return e.filter((e=>e.startTime>=t-s&&e.endTime<=i+s))}delayedUnmute(e,t){e.unmute(t,null,!0),this.unmuteTimeout=null}fillerAudioHandlePause(){this.fillerAudio.pause()}fillerAudioHandlePlay(){this.muted&&this.fillerAudio.play()}getSiteKey(){return this.sites.hasOwnProperty(this.filter.hostname)?this.filter.hostname:this.filter.iframe&&this.filter.iframe.hostname&&this.sites.hasOwnProperty(this.filter.iframe.hostname)?this.filter.iframe.hostname:""}getVideoTextTrack(e,t,i){let s=0,a=0,o=!1,r=0;i&&t[i]&&(r+=1e3),t.videoCueLabel&&(r+=100),t.videoCueLanguage&&(r+=10),t.videoCueKind&&(r+=1);for(let n=0;n<e.length;n++){const l=e[n];if(!l.cues||0===l.cues.length)continue;if(t.videoCueRequireShowing&&"showing"!==l.mode)continue;let d=0;if(i&&t[i]&&this.textTrackKeyTest(l,c.textTrackRuleMappings[i],t[i])&&(d+=1e3),t.videoCueLabel&&this.textTrackKeyTest(l,c.textTrackRuleMappings.videoCueLabel,t.videoCueLabel)&&(d+=100),t.videoCueLanguage&&this.textTrackKeyTest(l,c.textTrackRuleMappings.videoCueLanguage,t.videoCueLanguage)&&(d+=10),t.videoCueKind?this.textTrackKeyTest(l,c.textTrackRuleMappings.videoCueKind,t.videoCueKind)&&(d+=1):(this.textTrackKeyTest(l,c.textTrackRuleMappings.videoCueKind,"captions")||this.textTrackKeyTest(l,c.textTrackRuleMappings.videoCueKind,"subtitles"))&&(d+=1),d===r)return l;(d>a||!o)&&(a=d,s=n,o=!0)}if(o)return e[s]}hideCue(e,t){t.text="",t.position=100,t.size=0}hideSubtitles(e,t){if(e.displayVisibility&&e._displayElement)e._displayElement.style.visibility="hidden";else if(e.displaySelector){const i=e.rootNode&&t&&t[0]?t[0].getRootNode():document;if(i){let t=(0,o.getElement)(e.displaySelector,i);t&&e.displaySelectorParents&&(t=(0,o.getParent)(t,e.displaySelectorParents)),t&&(""===e.displayShow&&""!==t.style.display&&t.style.display!==e.displayHide&&(e.displayShow=t.style.display),t.style.setProperty("display",e.displayHide))}}else t&&t.forEach((t=>{t.innerText="",e.removeSubtitleSpacing&&t.style&&(t.style.padding&&(t.style.padding=0),t.style.margin&&(t.style.margin=0))}))}initCueRule(e){!0===e.apfCaptions&&(e.videoCueHideCues=!0),void 0===e.videoCueRequireShowing&&(e.videoCueRequireShowing=this.filter.cfg.muteCueRequireShowing),e.externalSub&&(void 0===e.externalSubTrackMode&&(e.externalSubTrackMode="showing"),void 0===e.externalSubURLKey&&(e.externalSubURLKey="url"),void 0===e.externalSubFormatKey&&(e.externalSubFormatKey="format"),void 0===e.externalSubTrackLabel&&(e.externalSubTrackLabel="APF"))}initDisplaySelector(e){void 0!==e.displaySelector&&(void 0===e.displayHide&&(e.displayHide="none"),void 0===e.displayShow&&(e.displayShow=""))}initDynamicRule(e){e._dynamic=!0,null==e.dynamicTargetMode&&e.disabled}initElementChildRule(e){e.parentSelector||e.parentSelectorAll||(e.disabled=!0)}initElementRule(e){}initFillerAudio(e=""){const t=c.fillerConfig[e];if(t){const e=chrome.runtime.getURL(t.fileName),i=new Audio;return i.src=e,i.loop=!0,t.volume&&(i.volume=t.volume),t.loopAfter&&(i.ontimeupdate=()=>{i.currentTime>t.loopAfter&&(i.currentTime=0)}),this.fillerAudioPauseHandler=this.fillerAudioHandlePause.bind(this),this.fillerAudioPlayHandler=this.fillerAudioHandlePlay.bind(this),i}}initRule(e){const t=this.rules.indexOf(e);if((void 0===e.mode||("element"==e.mode||"elementChild"==e.mode)&&!e.tagName||!0===e.iframe&&null==this.filter.iframe||!1===e.iframe&&null!=this.filter.iframe)&&(e.disabled=!0),e.disabled)u.warn("Audio rule disabled",e);else{switch(null==e.filterSubtitles&&(e.filterSubtitles=!0),0==this.filter.filterText&&(e.filterSubtitles=!1),void 0===e.videoSelector&&(e.videoSelector=c.defaultVideoSelector),this.initDisplaySelector(e),null==e.muteMethod&&(e.muteMethod=this.filter.cfg.muteMethod),null==e.showSubtitles&&(e.showSubtitles=this.filter.cfg.showSubtitles),null!=e.tagName&&"#text"!=e.tagName&&(e.tagName=e.tagName.toUpperCase()),e.mode){case"cue":this.initCueRule(e),e.disabled||this.cueRuleIds.push(t);break;case"dynamic":this.initDynamicRule(e);break;case"elementChild":this.initElementChildRule(e);break;case"element":this.initElementRule(e);break;case"text":this.initTextRule(e);break;case"watcher":this.initWatcherRule(e),e.disabled||this.watcherRuleIds.push(t);break;case"ytauto":e.disabled=!0}e.disabled?"ytauto"!=e.mode&&u.warn("Audio rule disabled during initialization",e):(this.enabledRuleIds.push(t),"watcher"==e.mode&&(e.toCue?setInterval(this.watcherToCue,e.checkInterval,this,t):setInterval(this.watcher,e.checkInterval,this,t)))}}initTextRule(e){e.tagName="#text",void 0===e.simpleUnmute&&(e.simpleUnmute=!0)}initWatcherRule(e){void 0===e.apfCuesLabel&&(e.apfCuesLabel="APF-Cues"),void 0===e.checkInterval&&(e.checkInterval=20),void 0===e.ignoreMutations&&(e.ignoreMutations=!0),void 0===e.simpleUnmute&&(e.simpleUnmute=!0)}initYouTube(){if(["m.youtube.com","tv.youtube.com","www.youtube.com"].includes(this.siteKey)){this.youTube=!0;const e="\\[\\s__\\s\\]",t={lists:this.wordlistId===s.default.ALL_WORDS_WORDLIST_ID?[]:[this.wordlistId],matchMethod:s.default.MATCH_METHODS.REGEX,repeat:s.default.FALSE,separators:s.default.FALSE,sub:"[ _ ]"};this.filter.cfg.addWord(e,t),this.youTubeAutoSubsRule={mode:"ytauto"},this.initRule(this.youTubeAutoSubsRule)}}mute(e,t){if(!this.muted){switch(this.muted=!0,this.filter.cfg.collectStats&&this.filter.stats.mutes++,e.muteMethod){case s.default.MUTE_METHODS.TAB:chrome.runtime.sendMessage({mute:!0});break;case s.default.MUTE_METHODS.VIDEO_MUTE:t||(t=(0,o.getElement)(e.videoSelector)),t&&!t.muted&&(t.muted=!0),this.fillerAudio&&this.playFillerAudio(t);break;case s.default.MUTE_METHODS.VIDEO_VOLUME:t||(t=(0,o.getElement)(e.videoSelector)),t&&null!=t.volume&&(this.volume=t.volume,t.volume=0),this.fillerAudio&&this.playFillerAudio(t)}u.debugTime("mute()")}e&&e.unmuteDelay&&this.unmuteTimeout&&this.clearUnmuteTimeout(e)}newCue(e,t,i,s={}){try{const a="string"==typeof e?(0,o.hmsToSeconds)(e):e,r="string"==typeof t?(0,o.hmsToSeconds)(t):t,n=new VTTCue(a,r,i);return s.align&&(n.align=s.align),s.line&&(n.line=this.parseLineAndPositionSetting(s.line)),s.position&&(n.position=this.parseLineAndPositionSetting(s.position)),n}catch(s){u.error(`Failed to add cue: ( start: ${e}, end: ${t}, text: ${i} )`,s)}}newTextTrack(e,t,i){if(t.textTracks){const s=t.addTextTrack("captions",e.externalSubTrackLabel,e.videoCueLanguage);s.mode=e.externalSubTrackMode;for(let e=0;e<i.length;e++)s.addCue(i[e]);return s}}parseLineAndPositionSetting(e){if("string"==typeof e&&""!=e)return"auto"==e?"auto":parseInt(e)}parseSRT(e){const t=e.trim().replace("\r\n","\n").split(/[\r\n]/).map((e=>e.trim())),i=[];let s=null,a=null,o=null;for(let e=0;e<t.length;e++)if(t[e].indexOf("--\x3e")>=0){const i=t[e].split(/[ \t]+-->[ \t]+/);if(2!=i.length)throw new Error(`Error when splitting "--\x3e": ${t[e]}.`);s=i[0],a=i[1]}else if(""==t[e]){if(s&&a){const e=this.newCue(s,a,o);i.push(e),s=null,a=null,o=null}}else s&&a&&(null==o?o=t[e]:o+="\n"+t[e]);if(s&&a){const e=this.newCue(s,a,o);i.push(e)}return i}parseSSA(e){const t=[];let i,s,a,o=!1;const r=e.split("\n");for(let e=0;e<r.length;e++)if(o){if(r[e].match(/^format:/i)){const t=r[e].trim().split(",");i=t.indexOf("End"),s=t.indexOf("Start"),a=t.indexOf("Text")}else if(r[e].match(/^dialogue:/i)){const o=r[e].trim().split(","),n=o[s],l=o[i],d=o.slice(a).join(",").replace(/\{\\\w.+?\}/g,"").split("\\N").reverse();for(let e=0;e<d.length;e++)t.push(this.newCue(n,l,d[e]))}}else r[e].match(/^\[Events\]/i)&&(o=!0);return t}parseVTT(e){const t=[],i=e.split("\n"),s=new RegExp("\\s--\x3e\\s");for(let e=0;e<i.length;e++){const a=i[e].trim();if(a.match(s)){const r=a.replace(s," ").split(" ");let[n,l,...d]=r;n=n.replace(",","."),l=l.replace(",",".");const u=d.map((e=>e.split(":"))).reduce(((e,t)=>(e[t[0]]=t[1],e)),{}),c=i[e-1].trim(),h=i[e+1].trim(),p=new RegExp(`^<[cs]\\.${c}>`),m=new RegExp("</[cs]>$");let f;if(f=h.match(p)?h.replace(p,"").replace(m,""):h,c&&!c.match(/_1$/)){const e=t[t.length-1];e.startTime!=(0,o.hmsToSeconds)(n)&&e.endTime==(0,o.hmsToSeconds)(l)&&(n=(0,o.secondsToHMS)(e.startTime))}const g=this.newCue(n,l,f,u);if(c&&!c.match(/_1$/)){const e=parseInt(c.match(/_([2-9])$/)[1]),i=t.length-e+1;t.splice(i,0,g)}else t.push(g);e++}}return t}playFillerAudio(e){this.playing(e)&&(this.fillerAudio.play(),e.addEventListener("pause",this.fillerAudioPauseHandler),e.addEventListener("play",this.fillerAudioPlayHandler))}playing(e){return!!(e&&e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2)}processCues(e,t){for(let i=0;i<e.length;i++){const s=e[i];if(s.hasOwnProperty("filtered"))continue;t.videoCueSync&&(s.startTime+=t.videoCueSync,s.endTime+=t.videoCueSync);const a=this.replaceTextResult(s.text);s.originalText=s.text,a.modified?(s.filtered=!0,t.filterSubtitles&&(s.text=a.filtered)):s.filtered=!1}}async processExternalSub(e,t){const i=this.getVideoTextTrack(e.textTracks,t,"externalSubTrackLabel");if(!this.fetching&&!i)try{let i;if(i=3==n.default.BUILD.manifestVersion?await(0,o.getGlobalVariableFromBackground)(t.externalSubVar):(0,o.getGlobalVariable)(t.externalSubVar),!Array.isArray(i))throw new Error(`Failed to find subtitle variable: ${t.externalSubVar}.`);{const s=i.find((e=>e.language===t.videoCueLanguage));if(!s)throw new Error(`Failed to find subtitle for language: ${t.videoCueLanguage}.`);let a;if(this.fetching=!0,a="bookmarklet"==n.default.BUILD.target?await(0,o.makeRequest)(s[t.externalSubURLKey],"GET"):await(0,o.makeBackgroundRequest)(s[t.externalSubURLKey],"GET"),"string"!=typeof a||!a)throw new Error(`Failed to download external subtitles from '${s[t.externalSubURLKey]}'.`);{let i;switch(s[t.externalSubFormatKey]){case"ass":i=this.parseSSA(a);break;case"srt":i=this.parseSRT(a);break;case"vtt":i=this.parseVTT(a);break;default:throw new Error(`Unsupported subtitle type: ${s[t.externalSubFormatKey]}.`)}if(i){const s=this.newTextTrack(t,e,i).cues;if(this.processCues(s,t),this.fetching=!1,t.displaySelector){const e=document.querySelector(t.displaySelector);e&&(e.style.display="none")}}}}}catch(e){u.error(`Error using external subtitles for ${this.siteKey}.`,e)}}processWatcherCaptions(e,t,i){const s=i.initialCall;if(s){if(this.lastProcessedText&&this.lastProcessedText===t.textContent)return i.skipped=!0,!1;this.unmute(e),this.lastProcessedText="",i.initialCall=!1}if(t.hasChildNodes())t.childNodes.forEach((t=>{this.processWatcherCaptions(e,t,i)}));else{const s="#text"===(t&&t.nodeName)?"textContent":"innerText";if(t[s]&&t[s].trim()){const a=this.replaceTextResult(t[s]);a.modified&&(this.mute(e),i.filtered=!0,e.filterSubtitles&&!e.apfCaptions&&(t[s]=a.filtered)),i.textResults.push(a)}}s&&(this.lastProcessedText=t.textContent)}processWatcherCaptionsArray(e,t,i){const s=t.map((e=>e.textContent)).join(" ");if(this.lastProcessedText&&this.lastProcessedText===s)return i.skipped=!0,!1;this.unmute(e),this.lastProcessedText="",t.forEach((t=>{if(t.textContent&&t.textContent.trim()){const s=this.replaceTextResult(t.textContent);s.modified&&(this.mute(e),i.filtered=!0,e.filterSubtitles&&!e.apfCaptions&&(t.textContent=s.filtered)),i.textResults.push(s)}})),this.lastProcessedText=t.map((e=>e.textContent)).join(" ")}replaceTextResult(e,t=this.wordlistId,i=s.default.STATS_TYPE_AUDIO){return this.filter.replaceTextResult(e,t,i)}showSubtitles(e,t){if(e.displayVisibility&&e._displayElement)e._displayElement.style.visibility="visible";else if(e.displaySelector){const i=e.rootNode&&t&&t[0]?t[0].getRootNode():document;if(i){let t=(0,o.getElement)(e.displaySelector,i);t&&e.displaySelectorParents&&(t=(0,o.getParent)(t,e.displaySelectorParents)),t&&t.style.setProperty("display",e.displayShow)}}}stopFillerAudio(){this.fillerAudio.pause(),this.fillerAudio.currentTime=0}subtitlesShouldBeShown(e,t=!1){switch(e.showSubtitles){case s.default.SHOW_SUBTITLES.ALL:return!0;case s.default.SHOW_SUBTITLES.FILTERED:return t;case s.default.SHOW_SUBTITLES.UNFILTERED:return!t;case s.default.SHOW_SUBTITLES.NONE:return!1}}supportedNode(e){for(let t=0;t<this.enabledRuleIds.length;t++){const i=this.enabledRuleIds[t],s=this.rules[i];switch(s.mode){case"element":if(e.nodeName==s.tagName){let t=!1;if(t||!s.className||e.className&&e.classList.contains(s.className)||(t=!0),t||!s.dataPropPresent||e.dataset&&e.dataset.hasOwnProperty(s.dataPropPresent)||(t=!0),t||!s.hasChildrenElements||"number"==typeof e.childElementCount&&0!=e.childElementCount||(t=!0),t||!s.subtitleSelector||"function"==typeof e.querySelector&&e.querySelector(s.subtitleSelector)||(t=!0),t||!s.containsSelector||"function"==typeof e.querySelector&&e.querySelector(s.containsSelector)||(t=!0),!t)return i}break;case"elementChild":if(e.nodeName===s.tagName){const t=s.rootNode?e.getRootNode():document;if(t)if(s.parentSelector){const a=t.querySelector(s.parentSelector);if(a&&(a==e||a.contains(e)))return i}else{const a=t.querySelectorAll(s.parentSelectorAll);for(let t=0;t<a.length;t++)if(a[t].contains(e))return i}}break;case"text":if(e.nodeName===s.tagName){const t=document.querySelector(s.parentSelector);if(t&&t.contains(e))return i}break;case"watcher":if(null!=s.subtitleSelector&&e.parentElement&&e.parentElement==(0,o.getElement)(s.subtitleSelector))return i;if(null!=s.parentSelector){const t=(0,o.getElement)(s.parentSelector);if(t&&t.contains(e))return i}break;case"dynamic":e.textContent===s.dynamicTextKey&&(s.mode=s.dynamicTargetMode,s.parentSelectorAll=`${e.tagName.toLowerCase()}.${Array.from(e.classList).join(".")} ${s.parentSelectorAll}`,this.initRule(s))}}return!1}textTrackKeyTest(e,t,i){return e[t]&&i&&e[t]===i}unmute(e,t,i=!1){if(this.muted){if(!i&&e&&e.unmuteDelay>=0)return null==this.unmuteTimeout&&this.clearUnmuteTimeout(e),void(this.unmuteTimeout=window.setTimeout(this.delayedUnmute,e.unmuteDelay,this,e));switch(this.muted=!1,e.muteMethod){case s.default.MUTE_METHODS.TAB:chrome.runtime.sendMessage({mute:!1});break;case s.default.MUTE_METHODS.VIDEO_MUTE:this.fillerAudio&&this.stopFillerAudio(),t||(t=(0,o.getElement)(e.videoSelector)),t&&t.muted&&(t.muted=!1);break;case s.default.MUTE_METHODS.VIDEO_VOLUME:this.fillerAudio&&this.stopFillerAudio(),t||(t=(0,o.getElement)(e.videoSelector)),t&&null!=t.volume&&(t.volume=this.volume)}u.debugTime("unmute()")}}watcher(e,t=0){const i=e.rules[t],s=(0,o.getElement)(i.videoSelector);if(s&&e.playing(s)){i.ignoreMutations&&e.filter.stopObserving();const t={filtered:!1,initialCall:!0,textResults:[]};let a;if(i.apfCaptions&&i.displaySelector&&e.hideSubtitles(i),i.parentSelector?(a=document.querySelector(i.parentSelector),a&&a.textContent&&a.textContent.trim()?e.processWatcherCaptions(i,a,t):e.watcherSimpleUnmute(i,s)):i.subtitleSelector&&(a=Array.from((0,o.getElements)(i.subtitleSelector)),a&&a.length?(!i.displayVisibility||i._displayElement&&document.body.contains(i._displayElement)||(i._displayElement=(0,o.getParent)(a[0],i.displayElementLevels)),e.processWatcherCaptionsArray(i,a,t)):e.watcherSimpleUnmute(i,s)),t.skipped)return!1;const r=e.subtitlesShouldBeShown(i,t.filtered);if(i.apfCaptions){let a;i.apfCaptionsSelector&&(a=(0,o.getElement)(i.apfCaptionsSelector)),a||(a=s.parentElement);const n=(0,o.getElement)("div.APF-subtitles",a);if(n&&n.remove(),r&&t.textResults.length){const s=t.textResults.map((e=>i.filterSubtitles&&e.modified?e.filtered:e.original)).map((t=>e.apfCaptionLine(i,t))),o=e.apfCaptionLines(i,s);a.appendChild(o)}}else r?e.showSubtitles(i):e.hideSubtitles(i);t.filtered&&e.filter.updateCounterBadge()}else i.ignoreMutations&&e.filter.startObserving()}watchForVideo(e){for(let t=0;t<e.cueRuleIds.length;t++){const i=e.rules[t],a=(0,o.getElement)(i.videoSelector);if(a&&a.textTracks&&e.playing(a)){i.externalSub&&e.processExternalSub(a,i);const t=e.getVideoTextTrack(a.textTracks,i);if(t&&!t.oncuechange){i.videoCueHideCues||i.showSubtitles!==s.default.SHOW_SUBTITLES.NONE||(t.mode="hidden"),t.oncuechange=()=>{if(t.activeCues&&t.activeCues.length>0){const s=Array.from(t.activeCues),o=[];if(!s.some((e=>e.hasOwnProperty("filtered")))){const s=Array.from(t.cues);e.processCues(s,i)}const r=s.some((e=>e.filtered));r?e.mute(i,a):e.unmute(i,a);const n=e.subtitlesShouldBeShown(i,r);for(let t=0;t<s.length;t++){const a=s[t];if(!n&&i.videoCueHideCues&&e.hideCue(i,a),i.apfCaptions){const t=r?a.text:a.originalText,s=e.apfCaptionLine(i,t);o.unshift(s)}}if(o.length){const t=document.getElementById(i.apfCaptionsSelector),s=t.querySelector("div.APF-subtitles");if(s&&s.remove(),n){const s=e.apfCaptionLines(i,o);t.appendChild(s)}}i.videoCueHideCues||(t.mode=n?"showing":"hidden"),i.displaySelector&&(o.length||!n?e.hideSubtitles(i):e.showSubtitles(i))}else if(e.unmute(i,a),i.apfCaptions){const e=document.getElementById(i.apfCaptionsSelector).querySelector("div.APF-subtitles");e&&e.remove()}};const o=Array.from(t.cues);e.processCues(o,i)}}}}watcherSimpleUnmute(e,t){this.unmute(e,t),e.showSubtitles>s.default.SHOW_SUBTITLES.ALL&&this.hideSubtitles(e)}watcherToCue(e,t=0){const i=e.rules[t],s=(0,o.getElement)(i.videoSelector);if(s&&e.playing(s)){i.ignoreMutations&&e.filter.stopObserving(),e.hideSubtitles(i);const t=e.apfTextTrack(i,s),a=s.currentTime,r={filtered:!1,initialCall:!0,textResults:[]};let n;if(i.subtitleSelector)if(n=Array.from((0,o.getElements)(i.subtitleSelector)),n&&n.length){const o=n.map((e=>e.textContent)).join(" ");if(e.lastProcessedText&&e.lastProcessedText===o)return r.skipped=!0,!1;{if(e.unmute(i,s),e.lastProcessedText=o,t&&t.activeCues&&t.activeCues.length){Array.from(t.activeCues).forEach((e=>e.endTime=a-.001))}const l=s.duration;n.reverse(),n.forEach((o=>{if(o.textContent&&o.textContent.trim()){const n=e.replaceTextResult(o.textContent);r.textResults.push(n),n.modified&&(e.mute(i,s),r.filtered=!0);const d=i.filterSubtitles?n.filtered:n.original,u=e.newCue(a,l,d);u.filtered=r.filtered,u.originalText=n.original,t.addCue(u)}}));const d=e.subtitlesShouldBeShown(i,r.filtered);i.videoCueHideCues||(t.mode=d?"showing":"hidden")}}else{if(e.watcherSimpleUnmute(i,s),t&&t.activeCues&&t.activeCues.length){Array.from(t.activeCues).forEach((e=>e.endTime=a-.001))}const o=e.subtitlesShouldBeShown(i,r.filtered);i.videoCueHideCues||(t.mode=o?"showing":"hidden")}if(r.skipped)return!1;r.filtered&&e.filter.updateCounterBadge()}else i.ignoreMutations&&e.filter.startObserving()}youTubeAutoSubsCurrentRow(e){return!(e.parentElement.parentElement!=e.parentElement.parentElement.parentElement.lastChild)}youTubeAutoSubsMuteTimeout(e){const t=window.document.querySelector(c.defaultVideoSelector);t&&e.playing(t)&&e.unmute(e.youTubeAutoSubsRule),e.youTubeAutoSubsTimeout=null}youTubeAutoSubsNodeIsSubtitleText(e){const t=document.querySelector("div.caption-window");return!(!t||!t.contains(e))}youTubeAutoSubsPresent(){return!!document.querySelector("div.ytp-caption-window-rollup")}youTubeAutoSubsSupportedNode(e){return"#text"==e.nodeName&&""!=e.textContent&&!!this.youTubeAutoSubsNodeIsSubtitleText(e)}}t.default=c,d(c,"brTagRegExp",new RegExp("<br>","i")),d(c,"defaultVideoSelector","video"),d(c,"fillerConfig",{beep:{fileName:"audio/beep.mp3",volume:.2},crickets:{fileName:"audio/crickets.mp3",volume:.4},static:{fileName:"audio/static.mp3",volume:.3}}),d(c,"textTrackRuleMappings",{externalSubTrackLabel:"label",videoCueKind:"kind",videoCueLabel:"label",videoCueLanguage:"language"})},502:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.supportedSites=t.safariTargetConfig=t.iOSTargetConfig=t.defaultTargetConfig=void 0;var s,a=(s=i(357))&&s.__esModule?s:{default:s};t.defaultTargetConfig={disabledSites:[],sites:{}};t.iOSTargetConfig={disabledSites:["www.hidive.com","watch.sling.com"],sites:{"play.stan.com.au":[{mode:"cue",videoCueLanguage:"en"}]}};t.safariTargetConfig={disabledSites:[],sites:{"play.stan.com.au":[{mode:"cue",videoCueLanguage:"en"}]}};const o={"abc.com":[{className:"akamai-caption-text",mode:"element",tagName:"DIV"},{className:"amp-caption-area",displaySelector:"div.amp-caption-area",mode:"element",muteMethod:a.default.MUTE_METHODS.VIDEO_VOLUME,subtitleSelector:"div.amp-caption > p",tagName:"DIV"}],"iview.abc.net.au":[{mode:"element",subtitleSelector:"div.jw-text-track-cue",tagName:"div"}],"acorn.tv":[{iframe:!0,mode:"elementChild",parentSelector:"div.vjs-text-track-display",simpleUnmute:!0,subtitleSelector:":scope div > div",tagName:"DIV"}],"smile.amazon.com":[{displayHide:"none",displaySelector:"div.webPlayerContainer div.f35bt6a",displayShow:"",iframe:!1,mode:"watcher",parentSelector:"div.webPlayerContainer div span > span",videoSelector:"div.webPlayerElement video[src]"}],"www.amazon.co.uk":[{displayHide:"none",displaySelector:"div.webPlayerContainer div.f35bt6a",displayShow:"",iframe:!1,mode:"watcher",parentSelector:"div.webPlayerContainer div span > span",videoSelector:"div.webPlayerElement video[src]"}],"www.amazon.com":[{displayHide:"none",displaySelector:"div.webPlayerContainer div.f35bt6a",displayShow:"",iframe:!1,mode:"watcher",parentSelector:"div.webPlayerContainer div span > span",videoSelector:"div.webPlayerElement video[src]"}],"www.amc.com":[{className:"ttr-container",mode:"element",subtitleSelector:"span.ttr-cue",tagName:"DIV"},{mode:"cue",videoCueLanguage:"en",videoSelector:"video"}],"tv.apple.com":[{apfCaptions:!0,displaySelector:"apple-tv-plus-player >>> amp-video-player-internal >>> amp-video-player >>> div.video-container > div",mode:"watcher",subtitleSelector:"apple-tv-plus-player >>> amp-video-player-internal >>> amp-video-player >>> div.video-container > div > div > div > div",videoSelector:"apple-tv-plus-player >>> amp-video-player-internal >>> amp-video-player >>> div.video-container video"}],"www.att.tv":[{mode:"cue",videoSelector:"video#quickplayPlayer"}],"www.attwatchtv.com":[{mode:"cue",videoSelector:"video#quickplayPlayer"}],"www.bbc.co.uk":[{displaySelector:"smp-toucan-player >>> smp-video-layout >>> smp-subtitles >>> div",iframe:!1,mode:"watcher",subtitleSelector:"smp-toucan-player >>> smp-video-layout >>> smp-subtitles >>> div[lang] p span span",videoSelector:"smp-toucan-player >>> smp-playback >>> video"}],"www.britbox.com":[{className:"bmpui-ui-subtitle-label",mode:"element",tagName:"SPAN"},{className:"bmpui-subtitle-region-container",mode:"element",subtitleSelector:"div.bmpui-container-wrapper > span.bmpui-ui-subtitle-label",tagName:"div"}],"gem.cbc.ca":[{className:"jw-text-track-container",mode:"element",subtitleSelector:"div.jw-text-track-cue",tagName:"DIV"}],"www.cbs.com":[{mode:"cue",videoCueLanguage:"en",videoCueRequireShowing:!1}],"www.channel4.com":[{displaySelector:"div.subtitles-container",mode:"elementChild",parentSelector:"div.subtitles-container",tagName:"SPAN"}],"www.crackle.com":[{ignoreMutations:!0,mode:"elementChild",parentSelector:"div.clpp-subtitles-container",simpleUnmute:!0,tagName:"#text"}],"www.criterionchannel.com":[{iframe:!0,mode:"cue",videoCueHideCues:!0,videoCueRequireShowing:!1}],"beta.crunchyroll.com":[{apfCaptions:!0,apfCaptionsSelector:"vilosVttJs",displaySelector:"canvas#velocity-canvas",externalSub:!0,externalSubTrackMode:"hidden",externalSubVar:"window.v1config.media.subtitles",iframe:!0,mode:"cue",videoCueLanguage:"en-US",videoCueRequireShowing:!1}],"www.crunchyroll.com":[{apfCaptions:!0,apfCaptionsSelector:"vilosVttJs",displaySelector:"canvas#velocity-canvas",externalSub:!0,externalSubTrackMode:"hidden",externalSubVar:"window.v1config.media.subtitles",iframe:!0,mode:"cue",videoCueLanguage:"enUS",videoCueRequireShowing:!1,videoSelector:"video#player0"}],"www.cwtv.com":[{className:"ttr-container",convertBreaks:!0,mode:"element",subtitleSelector:"span.ttr-cue",tagName:"DIV"},{className:"ttr-line",convertBreaks:!0,mode:"element",note:"[CC]",subtitleSelector:"span.ttr-cue",tagName:"DIV"}],"www.dailywire.com":[{mode:"cue"}],"www.discoveryplus.com":[{displaySelector:"div.cjRVXG",mode:"cue",videoCueKind:"captions",videoCueLanguage:"en"}],"www.dishanywhere.com":[{className:"bmpui-ui-subtitle-label",mode:"element",tagName:"SPAN"},{className:"bmpui-subtitle-region-container",mode:"element",subtitleSelector:"div.bmpui-container-wrapper > span.bmpui-ui-subtitle-label",tagName:"div"}],"www.apps.disneyplus.com":[{displayHide:"none",displaySelector:"div#video-container div.shaka-text-container",displayShow:"flex",iframe:!1,mode:"watcher",note:"South Africa",subtitleSelector:"div#video-container div.shaka-text-container > span",videoSelector:"div#video-container video"}],"www.disneyplus.com":[{className:"dss-subtitle-renderer-wrapper",mode:"element",subtitleSelector:"div.dss-subtitle-renderer-cue-window span.dss-subtitle-renderer-line",tagName:"DIV"}],"www.fox.com":[{className:"jw-text-track-container",mode:"element",subtitleSelector:"div.jw-text-track-cue",tagName:"DIV"}],"www.fubo.tv":[{displayHide:"none",displaySelector:"div.bmpui-ui-subtitle-overlay",iframe:!1,mode:"watcher",parentSelector:"div.bmpui-ui-subtitle-overlay",subtitleSelector:"div.bmpui-ui-subtitle-overlay span"}],"www.funimation.com":[{displaySelector:"div > div.vjs-text-track-cue",mode:"element",subtitleSelector:"div.vjs-text-track-cue > div",tagName:"DIV"},{iframe:!0,mode:"elementChild",note:"Embedded videos",parentSelector:"div.vjs-text-track-display",simpleUnmute:!0,subtitleSelector:":scope div > div",tagName:"DIV"}],"fxnow.fxnetworks.com":[{iframe:!0,mode:"cue",videoSelector:"video"}],"play.google.com":[{className:"lava-timed-text-window",mode:"element",subtitleSelector:"span.lava-timed-text-caption",tagName:"DIV"}],"play.hbomax.com":[{apfCaptions:!0,displaySelector:"div[data-testid='CueBoxContainer']",displaySelectorParents:1,ignoreMutations:!0,mode:"watcher",subtitleSelector:"div[data-testid='CueBoxContainer'] > div > div > div"}],"www.hidive.com":[{className:"rmp-cc-container",mode:"element",subtitleSelector:"div.rmp-cc-cue > span",tagName:"DIV"}],"www.hulu.com":[{className:"caption-text-box",displaySelector:"div.caption-text-box",mode:"element",subtitleSelector:"p",tagName:"DIV"},{displaySelector:"div.CaptionBox",mode:"elementChild",parentSelector:"div.CaptionBox",tagName:"P"}],"www.itv.com":[{mode:"cue",videoCueLanguage:"en"}],"mediasetinfinity.mediaset.it":[{ignoreMutations:!0,mode:"elementChild",parentSelector:"div#playerContainer > div > div > div > div > div",simpleUnmute:!0,tagName:"#text",videoSelector:"div#playerContainer video"},{ignoreMutations:!0,mode:"elementChild",parentSelector:"div#playerContainer > div > div > div > div > div > div > div > div > div > div",simpleUnmute:!0,tagName:"DIV",videoSelector:"div#playerContainer video"}],"www.nbc.com":[{className:"ttr-line",mode:"element",subtitleSelector:"span.ttr-cue",tagName:"DIV"},{mode:"cue",videoCueLanguage:"en"}],"www.netflix.com":[{className:"player-timedtext-text-container",mode:"element",note:"Fallback compatibility",subtitleSelector:"span > span",tagName:"DIV"},{className:"player-timedtext-text-container",mode:"element",subtitleSelector:"span",tagName:"DIV"}],"www.paramountplus.com":[{mode:"cue",videoCueHideCues:!0,videoCueLanguage:"en",videoCueRequireShowing:!1,videoSelector:"div[data-role=videoContainer] video"}],"www.pbs.org":[{iframe:!0,mode:"element",subtitleSelector:"div.vjs-text-track-cue > div",tagName:"DIV"}],"www.peacocktv.com":[{displaySelector:"div.video-player__subtitles",mode:"elementChild",parentSelector:"div.video-player__subtitles > div",simpleUnmute:!0,tagName:"#text"},{displaySelector:"div.video-player__subtitles",mode:"elementChild",parentSelector:"div.video-player__subtitles > div",subtitleSelector:"SPAN > SPAN",tagName:"DIV"},{displaySelector:"div.video-player__subtitles",mode:"elementChild",parentSelector:"div.video-player__subtitles > div",tagName:"SPAN"}],"www.philo.com":[{mode:"cue"}],"app.plex.tv":[{dataPropPresent:"dialogueId",mode:"element",subtitleSelector:"span > span",tagName:"DIV"},{containsSelector:"div[data-dialogue-id]",mode:"element",subtitleSelector:"span > span",tagName:"DIV"}],"pluto.tv":[{mode:"cue",videoCueHideCues:!0,videoCueRequireShowing:!1}],"www.primevideo.com":[{displayHide:"none",displaySelector:"div.webPlayerContainer div.f35bt6a",displayShow:"",iframe:!1,mode:"watcher",parentSelector:"div.webPlayerContainer div span > span",videoSelector:"div.webPlayerElement video[src]"}],"www.raiplay.it":[{mode:"elementChild",parentSelector:"div.theoplayer-texttracks div.theoplayer-webvtt-region-default",subtitleSelector:"div span",tagName:"DIV"}],"www.redbox.com":[{mode:"elementChild",parentSelector:"div.rb-text-container",subtitleSelector:"SPAN > SPAN",tagName:"DIV"}],"watch.redeemtv.com":[{convertBreaks:!0,displaySelector:"div.vp-captions",mode:"elementChild",parentSelector:"div.vp-captions",tagName:"SPAN"}],"therokuchannel.roku.com":[{mode:"element",subtitleSelector:"div.vjs-text-track-cue > div",tagName:"DIV"}],"row8.com":[{iframe:!1,mode:"watcher",parentSelector:"div.vjs-text-track-display div.vjs-text-track-cue",subtitleSelector:"div",videoSelector:"app-videojs-player video"}],"www.sbs.com.au":[{className:"bmpui-subtitle-region-container",mode:"element",subtitleSelector:"DIV.bmpui-container-wrapper > SPAN.bmpui-ui-subtitle-label > SPAN",tagName:"DIV"}],"www.showmax.com":[{ignoreMutations:!0,mode:"elementChild",parentSelector:"div.contentWrapper > div.subtitles--3EXhT",simpleUnmute:!0,tagName:"#text"}],"www.showtime.com":[{mode:"cue",videoCueHideCues:!0,videoCueLanguage:"en",videoCueRequireShowing:!1}],"watch.sling.com":[{className:"bmpui-subtitle-region-container",mode:"element",subtitleSelector:"DIV.bmpui-container-wrapper > SPAN.bmpui-ui-subtitle-label",tagName:"DIV"}],"play.stan.com.au":[{ignoreMutations:!0,mode:"elementChild",parentSelector:"div.clpp-text-container",simpleUnmute:!0,tagName:"DIV"}],"www.starz.com":[{mode:"elementChild",parentSelector:"starz-captions > div.cue-list",tagName:"SPAN"}],"www.syfy.com":[{className:"ttr-line",mode:"element",subtitleSelector:"span.ttr-cue",tagName:"DIV"}],"www.tntdrama.com":[{mode:"cue",videoCueLanguage:"en",videoSelector:"video.top-media-element"}],"tubitv.com":[{mode:"elementChild",parentSelector:"div#captionsComponent",tagName:"SPAN"}],"www.universalkids.com":[{mode:"element",subtitleSelector:"div.gwt-HTML",tagName:"DIV"}],"www.usanetwork.com":[{className:"ttr-line",mode:"element",subtitleSelector:"span.ttr-cue",tagName:"DIV"}],"vimeo.com":[{mode:"element",tagName:"SPAN",note:"Only tested with single-line captions",className:"vp-captions-line",displaySelector:"div.vp-captions > span.vp-captions-window"}],"player.vimeo.com":[{mode:"element",tagName:"SPAN",note:"For embedded videos",className:"vp-captions-line",displaySelector:"div.vp-captions > span.vp-captions-window"}],"www.vudu.com":[{displaySelector:"div#subtitleContainer > div",iframe:!0,mode:"element",subtitleSelector:"span.subtitles",tagName:"DIV"}],"vrv.co":[{displaySelector:"div.libassjs-canvas-parent",externalSub:!0,externalSubVar:"window.vilos.content.captions",iframe:!0,mode:"cue",videoCueLanguage:"en-US",videoCueRequireShowing:!1},{displaySelector:"div.libassjs-canvas-parent",externalSub:!0,externalSubVar:"window.vilos.content.subtitles",iframe:!0,mode:"cue",videoCueLanguage:"en-US",videoCueRequireShowing:!1}],"m.youtube.com":[{className:"caption-window",mode:"element",subtitleSelector:"span.ytp-caption-segment",tagName:"DIV"}],"tv.youtube.com":[{className:"caption-window",mode:"element",subtitleSelector:"span.ytp-caption-segment",tagName:"DIV"}],"www.youtube.com":[{className:"caption-window",mode:"element",subtitleSelector:"span.ytp-caption-segment",tagName:"DIV"}]};t.supportedSites=o},863:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=d(i(357)),a=d(i(513)),o=i(582),r=d(i(167)),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var i=l(t);if(i&&i.has(e))return i.get(e);var s={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=a?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(s,o,r):s[o]=e[o]}s.default=e,i&&i.set(e,s);return s}(i(178));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(l=function(e){return e?i:t})(e)}function d(e){return e&&e.__esModule?e:{default:e}}function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const c=new r.default("WebConfig");class h extends a.default{static get _maxBytes(){try{if(chrome.storage.sync.QUOTA_BYTES_PER_ITEM)return Math.round(.98*chrome.storage.sync.QUOTA_BYTES_PER_ITEM);throw"QUOTA_BYTES_PER_ITEM not defined, using default"}catch(e){return 8028}}static chromeStorageAvailable(){return!!(chrome&&chrome.storage&&chrome.storage.sync&&chrome.storage.local)}static combineData(e,t){if(e[t]={},void 0!==e[`_${t}0`]){const i=h.getDataContainerKeys(e,t);return i.forEach((i=>{Object.assign(e[t],e[i]),delete e[i]})),i}}static getDataContainerKeys(e,t){const i=new RegExp(`^_${t}\\d+`);return Object.keys(e).filter((e=>i.test(e))).sort()}static getLocalStorage(e){return"string"==typeof e&&(e=[e]),new Promise(((t,i)=>{chrome.storage.local.get(e,(e=>{chrome.runtime.lastError?i(chrome.runtime.lastError):t(e)}))}))}static getMaxSplitKeyFromArray(e=[]){if(Array.isArray(e)){const t=e.sort()[e.length-1];if(t){const e=new RegExp("\\d+$"),i=t.match(e);if(i)return parseInt(i[0])}}}static getMaxSplitKeyFromData(e,t){const i=h.getDataContainerKeys(e,t);return h.getMaxSplitKeyFromArray(i)}static getSyncStorage(e){return"string"==typeof e&&(e=[e]),new Promise(((t,i)=>{chrome.storage.sync.get(e,(e=>{chrome.runtime.lastError?i(chrome.runtime.lastError):t(e)}))}))}static includesLargeKeys(e){return e.some((e=>h._largeKeys.includes(e)))}static async load(e=[]){e=(0,o.stringArray)(e);const t={};let i;const s=[];let a=[];0===e.length&&(e=Object.keys(h._defaults)).push("words");try{if(h.includesLargeKeys(e)?(e.includes("syncLargeKeys")||e.push("syncLargeKeys"),h._localConfigKeys.forEach((t=>{e.includes(t)&&s.push(t)})),i=await h.getLocalStorage(s),t.syncLargeKeys=!1===i.syncLargeKeys?i.syncLargeKeys:h._defaults.syncLargeKeys,!1===t.syncLargeKeys?(s.forEach((e=>{void 0===i[e]?t[e]="words"===e?h._defaultWords:h._defaults[e]:t[e]=i[e]})),a=e.filter((e=>!h._localConfigKeys.includes(e)))):a=e.filter((e=>"syncLargeKeys"!==e))):a=e.filter((e=>"syncLargeKeys"!==e)),a.length){let e=[].concat(a);h._largeKeys.forEach((t=>{a.includes(t)&&(e.splice(e.indexOf(t),1),e=e.concat(h.splitKeyNames(t)))}));const i=await h.getSyncStorage(e);t._lastSplitKeys={},a.forEach((e=>{if(h._largeKeys.includes(e)){const s=h.combineData(i,e);s?(t._lastSplitKeys[e]=h.getMaxSplitKeyFromArray(s),t[e]=i[e]):(t._lastSplitKeys[e]=0,t[e]="words"===e?h._defaultWords:h._defaults[e])}else void 0===i[e]?t[e]=h._defaults[e]:t[e]=i[e]}))}return new h(t)}catch(t){throw c.error("Failed to load items.",e,t),new Error(`Failed to load items: ${(0,o.prettyPrintArray)(e)}. [${t.message}]`)}}static removeLocalStorage(e){return e=(0,o.stringArray)(e),new Promise(((t,i)=>{chrome.storage.local.remove(e,(()=>{chrome.runtime.lastError?i(chrome.runtime.lastError):t(0)}))}))}static removeSyncStorage(e){return e=(0,o.stringArray)(e),new Promise(((t,i)=>{chrome.storage.sync.remove(e,(()=>{chrome.runtime.lastError?i(chrome.runtime.lastError):t(0)}))}))}static resetLocalStorage(){return new Promise(((e,t)=>{chrome.storage.local.clear((()=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(0)}))}))}static resetSyncStorage(){return new Promise(((e,t)=>{chrome.storage.sync.clear((()=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(0)}))}))}static saveLocalStorage(e){return new Promise(((t,i)=>{chrome.storage.local.set(e,(()=>{chrome.runtime.lastError?i(chrome.runtime.lastError):t(0)}))}))}static saveSyncStorage(e){return new Promise(((t,i)=>{chrome.storage.sync.set(e,(()=>{chrome.runtime.lastError?i(chrome.runtime.lastError):t(0)}))}))}static splitKeyNames(e,t=0){return Array(this._maxSplitKeys-t).fill(1).map(((i,s)=>"_"+e+(s+t)))}constructor(e){if(void 0===e)throw new Error("Cannot be called directly, call load() instead.");super(),u(this,"_lastSplitKeys",void 0),u(this,"audioWordlistId",void 0),u(this,"collectStats",void 0),u(this,"contextMenu",void 0),u(this,"customAudioSites",void 0),u(this,"darkMode",void 0),u(this,"domains",void 0),u(this,"enabledDomainsOnly",void 0),u(this,"fillerAudio",void 0),u(this,"muteAudio",void 0),u(this,"muteAudioOnly",void 0),u(this,"muteCueRequireShowing",void 0),u(this,"muteMethod",void 0),u(this,"password",void 0),u(this,"showSubtitles",void 0),u(this,"showUpdateNotification",void 0),u(this,"syncLargeKeys",void 0),u(this,"youTubeAutoSubsMax",void 0),u(this,"youTubeAutoSubsMin",void 0),Object.assign(this,h._classDefaults,e)}ordered(){return Object.keys(this).sort().reduce(((e,t)=>("_"!=t[0]&&(e[t]=this[t]),e)),{})}async remove(e){e=(0,o.stringArray)(e);let t=[];const i=[];if(e.length>0){e.forEach((e=>{"syncLargeKeys"==e?i.push(e):h._largeKeys.includes(e)?this.syncLargeKeys?t=t.concat(h.splitKeyNames(e)):i.push(e):t.push(e)}));try{t.length&&await h.removeSyncStorage(t),i.length&&await h.removeLocalStorage(i),e.forEach((e=>{delete this[e]}))}catch(t){throw c.error("Failed to remove items.",e,t),new Error(`Failed to remove items: ${(0,o.prettyPrintArray)(e)}. ${t.message}`)}}}async reset(){try{await h.resetSyncStorage(),await h.resetLocalStorage()}catch(e){throw c.error("Failed to clear storage.",e),new Error(`Failed to clear storage. ${e.message}`)}}async resetPreserveStats(){try{await h.resetSyncStorage(),await h.removeLocalStorage(h._localConfigKeys)}catch(e){throw c.error("Failed to clear storage.",e),new Error(`Failed to clear storage. ${e.message}`)}}async save(e=[]){e=(0,o.stringArray)(e);const t={},i={};0===e.length&&(e=Object.keys(h._defaults)).push("words");let s=[];e.forEach((e=>{if("syncLargeKeys"==e)i[e]=this[e];else if(h._largeKeys.includes(e))if(this.syncLargeKeys){if(Object.assign(t,this.splitData(e)),this._lastSplitKeys){const i=h.getMaxSplitKeyFromData(t,e);this._lastSplitKeys[e]>i?s=s.concat(h.splitKeyNames(e,i+1)):this._lastSplitKeys[e]<i&&(this._lastSplitKeys[e]=i)}}else i[e]=this[e];else t[e]=this[e]}));try{if("safari"===n.target){const e=Object.keys(i).filter((e=>null==i[e])),s=Object.keys(t).filter((e=>null==t[e]));e.length&&(await h.removeLocalStorage(e),e.forEach((e=>delete i[e]))),s.length&&(await h.removeSyncStorage(s),s.forEach((e=>delete t[e])))}Object.keys(t).length&&await h.saveSyncStorage(t),Object.keys(i).length&&await h.saveLocalStorage(i),s.length&&await this.remove(s)}catch(t){throw c.error("Failed to save items.",e,t),new Error(`Failed to save items: ${(0,o.prettyPrintArray)(e)}. [${t.message}]`)}}splitData(e){const t=new TextEncoder;let i=0,s=2;const a={};let o=`_${e}${i}`;return a[o]={},s+=t.encode(`{"${o}":{}}`).length,Object.keys(this[e]).sort().forEach((r=>{let n=t.encode(`",${r}":`).length;n+=t.encode(JSON.stringify(this[e][r])).length,s+n>=h._maxBytes&&(i++,o=`_${e}${i}`,a[o]={},s=t.encode(`"${o}":{}`).length),s+=n,a[o][r]=this[e][r]})),a}}t.default=h,u(h,"BUILD",n),u(h,"_classDefaults",{audioWordlistId:0,collectStats:!0,contextMenu:!0,customAudioSites:null,darkMode:null,domains:{},enabledDomainsOnly:!1,fillerAudio:"",muteAudio:!1,muteAudioOnly:!1,muteCueRequireShowing:!1,muteMethod:h.BUILD.config.muteMethod||s.default.MUTE_METHODS.TAB,password:null,showSubtitles:s.default.SHOW_SUBTITLES.ALL,showUpdateNotification:!1,syncLargeKeys:!0,youTubeAutoSubsMax:0,youTubeAutoSubsMin:0}),u(h,"_defaults",Object.assign({},a.default._defaults,h._classDefaults)),u(h,"_localConfigKeys",["domains","syncLargeKeys","words"]),u(h,"_localOnlyKeys",["background","stats"]),u(h,"_maxSplitKeys",64),u(h,"_largeKeys",["domains","words"])},894:function(){
// @license http://unlicense.org/UNLICENSE
"undefined"!=typeof window&&(window.findAndReplaceDOMText=function(){var e="retain",t="first",i=document,s={}.hasOwnProperty;function a(e){return String(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function o(){return r.apply(null,arguments)||n.apply(null,arguments)}function r(e,t,i,s,a){if(t&&!t.nodeType&&arguments.length<=2)return!1;var r,l="function"==typeof i;l&&(r=i,i=function(e,t){return r(e.text,t.startIndex)});var d=n(t,{find:e,wrap:l?null:i,replace:l?i:"$"+(s||"&"),prepMatch:function(e,t){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";if(s>0){var i=e[s];e.index+=e[0].indexOf(i),e[0]=i}return e.endIndex=e.index+e[0].length,e.startIndex=e.index,e.index=t,e},filterElements:a});return o.revert=function(){return d.revert()},!0}function n(e,t){return new l(e,t)}function l(t,i){var a=i.preset&&o.PRESETS[i.preset];if(i.portionMode=i.portionMode||e,a)for(var r in a)s.call(a,r)&&!s.call(i,r)&&(i[r]=a[r]);this.node=t,this.options=i,this.prepMatch=i.prepMatch||this.prepMatch,this.reverts=[],this.matches=this.search(),this.matches.length&&this.processMatches()}return o.NON_PROSE_ELEMENTS={br:1,hr:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1},o.NON_CONTIGUOUS_PROSE_ELEMENTS={address:1,article:1,aside:1,blockquote:1,dd:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,nav:1,noscript:1,ol:1,output:1,p:1,pre:1,section:1,ul:1,br:1,li:1,summary:1,dt:1,details:1,rp:1,rt:1,rtc:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1,table:1,tbody:1,thead:1,th:1,tr:1,td:1,caption:1,col:1,tfoot:1,colgroup:1},o.NON_INLINE_PROSE=function(e){return s.call(o.NON_CONTIGUOUS_PROSE_ELEMENTS,e.nodeName.toLowerCase())},o.PRESETS={prose:{forceContext:o.NON_INLINE_PROSE,filterElements:function(e){return!s.call(o.NON_PROSE_ELEMENTS,e.nodeName.toLowerCase())}}},o.Finder=l,l.prototype={search:function(){var e,t=0,i=0,s=this.options.find,o=this.getAggregateText(),r=[],n=this;function l(a){for(var o=0,d=a.length;o<d;++o){var u=a[o];if("string"==typeof u){if(s.global)for(;e=s.exec(u);)r.push(n.prepMatch(e,t++,i));else(e=u.match(s))&&r.push(n.prepMatch(e,0,i));i+=u.length}else l(u)}}return s="string"==typeof s?RegExp(a(s),"g"):s,l(o),r},prepMatch:function(e,t,i){if(!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return e.endIndex=i+e.index+e[0].length,e.startIndex=i+e.index,e.index=t,e},getAggregateText:function(){var e=this.options.filterElements,t=this.options.forceContext;return i(this.node);function i(s){if(s.nodeType===Node.TEXT_NODE)return[s.data];if(e&&!e(s))return[];var a=[""],o=0;if(s=s.firstChild)do{if(s.nodeType!==Node.TEXT_NODE){var r=i(s);t&&s.nodeType===Node.ELEMENT_NODE&&(!0===t||t(s))?(a[++o]=r,a[++o]=""):("string"==typeof r[0]&&(a[o]+=r.shift()),r.length&&(a[++o]=r,a[++o]=""))}else a[o]+=s.data}while(s=s.nextSibling);return a}},processMatches:function(){var e,t,i,s=this.matches,a=this.node,o=this.options.filterElements,r=[],n=a,l=s.shift(),d=0,u=0,c=[a];e:for(;;){if(n.nodeType===Node.TEXT_NODE&&(!t&&n.length+d>=l.endIndex?t={node:n,index:u++,text:n.data.substring(l.startIndex-d,l.endIndex-d),indexInMatch:0===d?0:d-l.startIndex,indexInNode:l.startIndex-d,endIndexInNode:l.endIndex-d,isEnd:!0}:e&&r.push({node:n,index:u++,text:n.data,indexInMatch:d-l.startIndex,indexInNode:0}),!e&&n.length+d>l.startIndex&&(e={node:n,index:u++,indexInMatch:0,indexInNode:l.startIndex-d,endIndexInNode:l.endIndex-d,text:n.data.substring(l.startIndex-d,l.endIndex-d)}),d+=n.data.length),i=n.nodeType===Node.ELEMENT_NODE&&o&&!o(n),e&&t){if(n=this.replaceMatch(l,e,r,t),d-=t.node.data.length-t.endIndexInNode,e=null,t=null,r=[],u=0,!(l=s.shift()))break}else if(!i&&(n.firstChild||n.nextSibling)){n.firstChild?(c.push(n),n=n.firstChild):n=n.nextSibling;continue}for(;;){if(n.nextSibling){n=n.nextSibling;break}if((n=c.pop())===a)break e}}},revert:function(){for(var e=this.reverts.length;e--;)this.reverts[e]();this.reverts=[]},prepareReplacementString:function(e,i,s){var a=this.options.portionMode;return a===t&&i.indexInMatch>0?"":(e=e.replace(/\$(\d+|&|`|')/g,(function(e,t){var i;switch(t){case"&":i=s[0];break;case"`":i=s.input.substring(0,s.startIndex);break;case"'":i=s.input.substring(s.endIndex);break;default:i=s[+t]||""}return i})),a===t?e:i.isEnd?e.substring(i.indexInMatch):e.substring(i.indexInMatch,i.indexInMatch+i.text.length))},getPortionReplacementNode:function(e,t){var s=this.options.replace||"$&";if("function"==typeof s)return(s=s(e,t))&&s.nodeType?s:i.createTextNode(String(s))},replaceMatch:function(e,t,s,a){var o,r,n=t.node,l=a.node;if(n===l){var d=n;t.indexInNode>0&&(o=i.createTextNode(d.data.substring(0,t.indexInNode)),d.parentNode.insertBefore(o,d));var u=this.getPortionReplacementNode(a,e);return d.parentNode.insertBefore(u,d),a.endIndexInNode<d.length&&(r=i.createTextNode(d.data.substring(a.endIndexInNode)),d.parentNode.insertBefore(r,d)),d.parentNode.removeChild(d),this.reverts.push((function(){o===u.previousSibling&&o.parentNode.removeChild(o),r===u.nextSibling&&r.parentNode.removeChild(r),u.parentNode.replaceChild(d,u)})),u}o=i.createTextNode(n.data.substring(0,t.indexInNode)),r=i.createTextNode(l.data.substring(a.endIndexInNode));for(var c=this.getPortionReplacementNode(t,e),h=[],p=0,m=s.length;p<m;++p){var f=s[p],g=this.getPortionReplacementNode(f,e);f.node.parentNode.replaceChild(g,f.node),this.reverts.push(function(e,t){return function(){t.parentNode.replaceChild(e.node,t)}}(f,g)),h.push(g)}var v=this.getPortionReplacementNode(a,e);return n.parentNode.insertBefore(o,n),n.parentNode.insertBefore(c,n),n.parentNode.removeChild(n),l.parentNode.insertBefore(v,l),l.parentNode.insertBefore(r,l),l.parentNode.removeChild(l),this.reverts.push((function(){o.parentNode.removeChild(o),c.parentNode.replaceChild(n,c),r.parentNode.removeChild(r),v.parentNode.replaceChild(l,v)})),v}},o}())},178:e=>{"use strict";e.exports=JSON.parse('{"release":true,"config":{"muteMethod":null},"manifestVersion":0,"target":"bookmarklet","version":"2.37.1"}')}},t={};function i(s){var a=t[s];if(void 0!==a)return a.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,i),o.exports}(()=>{"use strict";i(894);var e=l(i(357)),t=l(i(50)),s=l(i(394)),a=l(i(470)),o=l(i(210)),r=l(i(863)),n=l(i(709));function l(e){return e&&e.__esModule?e:{default:e}}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}
/* @preserve - Start User Config */const u=r.default._defaults;u.words=r.default._defaultWords;
/* @preserve - End User Config */
class c extends s.default{constructor(){super(),d(this,"audio",void 0),d(this,"audioOnly",void 0),d(this,"audioWordlistId",void 0),d(this,"domain",void 0),d(this,"extension",void 0),d(this,"filterText",void 0),d(this,"hostname",void 0),d(this,"iframe",void 0),d(this,"location",void 0),d(this,"mutePage",void 0),d(this,"observer",void 0),d(this,"processMutationTarget",void 0),d(this,"processNode",void 0),d(this,"shadowObserver",void 0),d(this,"stats",void 0),d(this,"updateCounterBadge",void 0),this.extension=!1,this.filterText=!0,this.audioWordlistId=e.default.ALL_WORDS_WORDLIST_ID,this.mutePage=!1,this.processMutationTarget=!1}advancedReplaceText(t,i,s=e.default.STATS_TYPE_TEXT){t.parentNode||t===document?this.wordlists[i].regExps.forEach((e=>{findAndReplaceDOMText(t,{preset:"prose",find:e,replace:(e,t)=>0===e.index?this.replaceText(t[0],i,s):""})})):this.cleanText(t,i,s)}checkMutationForProfanity(e){e.addedNodes.forEach((e=>{a.default.isForbiddenNode(e)||(this.mutePage?this.cleanAudio(e):this.audioOnly||this.processNode(e,this.wordlistId))})),this.mutePage&&this.audio.muted&&e.removedNodes.forEach((e=>{const t=this.audio.supportedNode(e),i=!1!==t?this.audio.rules[t]:this.audio.rules[0];(!1!==t||e==this.audio.lastFilteredNode||e.contains(this.audio.lastFilteredNode)||i.simpleUnmute&&e.textContent&&this.audio.lastFilteredText&&this.audio.lastFilteredText.includes(e.textContent))&&this.audio.unmute(i)})),e.target&&("#text"===e.target.nodeName?this.checkMutationTargetTextForProfanity(e):this.processMutationTarget&&this.processNode(e.target,this.wordlistId))}checkMutationTargetTextForProfanity(e){if(!a.default.isForbiddenNode(e.target))if(this.mutePage){const t=this.audio.supportedNode(e.target),i=!1!==t?this.audio.rules[t]:this.audio.rules[0];if(!1!==t&&i.simpleUnmute)this.audio.muted&&e.oldValue&&this.audio.lastFilteredText&&this.audio.lastFilteredText.includes(e.oldValue)&&this.audio.unmute(i),this.audio.clean(e.target,t);else if(i.simpleUnmute&&this.audio.muted&&!e.target.parentElement)this.audio.lastFilteredText&&this.audio.lastFilteredText.includes(e.target.textContent)&&this.audio.unmute(i);else if(!this.audioOnly){const t=this.replaceTextResult(e.target.data,this.wordlistId);t.modified&&(e.target.data=t.filtered)}}else if(!this.audioOnly){const t=this.replaceTextResult(e.target.data,this.wordlistId);t.modified&&(e.target.data=t.filtered)}}cleanAudio(e){if(this.audio.youTube&&this.audio.youTubeAutoSubsPresent())this.audio.youTubeAutoSubsSupportedNode(e)?this.audio.youTubeAutoSubsCurrentRow(e)?this.audio.cleanYouTubeAutoSubs(e):this.audioOnly||this.processNode(e,this.wordlistId):this.audioOnly||this.audio.youTubeAutoSubsNodeIsSubtitleText(e)||this.processNode(e,this.wordlistId);else{const t=this.audio.supportedNode(e);!1!==t?this.audio.clean(e,t):this.audioOnly||this.processNode(e,this.wordlistId)}}cleanChildNode(t,i,s=e.default.STATS_TYPE_TEXT){if(t.nodeName)if(t.textContent&&""!=t.textContent.trim()){const e=this.replaceTextResult(t.textContent,i,s);e.modified&&this.filterText&&(t.textContent=e.filtered)}else"IMG"==t.nodeName?(this.cleanNodeAttribute(t,"alt",i,s),this.cleanNodeAttribute(t,"title",i,s)):t.shadowRoot&&this.filterShadowRoot(t.shadowRoot,i,s)}cleanNode(t,i,s=e.default.STATS_TYPE_TEXT){if(a.default.isForbiddenNode(t))return!1;if(t.shadowRoot&&this.filterShadowRoot(t.shadowRoot,i,s),t.childNodes.length>0)for(let e=0;e<t.childNodes.length;e++)this.cleanNode(t.childNodes[e],i,s);else this.cleanChildNode(t,this.wordlistId,s)}cleanNodeAttribute(t,i,s,a=e.default.STATS_TYPE_TEXT){if(""!=t[i]){const e=this.replaceTextResult(t[i],s,a);e.modified&&this.filterText&&(t[i]=e.filtered)}}cleanPage(){this.cfg=new r.default(u),this.filterText=this.cfg.filterMethod!==e.default.FILTER_METHODS.OFF,this.domain=t.default.byHostname(this.hostname,this.cfg.domains),this.cfg.muteMethod===e.default.MUTE_METHODS.TAB&&(this.cfg.muteMethod,e.default.MUTE_METHODS.VIDEO_VOLUME);const i={};return this.cfg.enabledDomainsOnly&&!this.domain.enabled&&!this.cfg.muteAudioOnly||this.domain.disabled?(i.disabled=!0,!1):(void 0!==this.domain.wordlistId&&(this.wordlistId=this.domain.wordlistId),void 0!==this.domain.audioWordlistId&&(this.audioWordlistId=this.domain.audioWordlistId),this.cfg.muteAudio&&(this.audio=new o.default(this),this.mutePage=this.audio.supportedPage,this.mutePage&&this.cfg.wordlistsEnabled&&this.wordlistId!=this.audio.wordlistId&&(this.wordlists[this.audio.wordlistId]=new n.default(this.cfg,this.audio.wordlistId))),this.cfg.muteAudioOnly&&!this.mutePage?(i.disabled=!0,!1):(this.init(),this.audioOnly||this.processNode(document,this.wordlistId),void this.startObserving(document)))}cleanText(t,i,s=e.default.STATS_TYPE_TEXT){if(a.default.isForbiddenNode(t))return!1;if(t.shadowRoot&&this.filterShadowRoot(t.shadowRoot,i,s),t.childElementCount>0){const e=document.createTreeWalker(t,NodeFilter.SHOW_TEXT);for(;e.nextNode();)e.currentNode.childNodes.length>0?e.currentNode.childNodes.forEach((e=>{this.cleanText(e,i,s)})):a.default.isForbiddenNode(e.currentNode)||this.cleanChildNode(e.currentNode,i,s)}else this.cleanChildNode(t,i,s)}filterShadowRoot(t,i,s=e.default.STATS_TYPE_TEXT){this.shadowObserver.observe(t,p),this.processNode(t,i,s)}init(e=!1){super.init(e),this.domain.advanced?this.processNode=this.advancedReplaceText:this.domain.deep?(this.processMutationTarget=!0,this.processNode=this.cleanNode):this.processNode=this.cleanText}processMutations(e){e.forEach((e=>{h.checkMutationForProfanity(e)}))}startObserving(e=document,t=this.observer){t.observe(e,p)}stopObserving(e=this.observer){const t=e.takeRecords();e.disconnect(),t&&this.processMutations(t)}}const h=new c,p={characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0};if("undefined"!=typeof window){if(h.observer=new MutationObserver(h.processMutations),h.shadowObserver=new MutationObserver(h.processMutations),window!=window.top){h.iframe=document.location;try{h.hostname=window.parent.location.hostname}catch(e){document.referrer?h.hostname=new URL(document.referrer).hostname:h.hostname=document.location.hostname}}else h.hostname=document.location.hostname;h.cleanPage()}})()})();